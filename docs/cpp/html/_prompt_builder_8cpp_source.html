<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RundeeItemFactory: RundeeItemFactory/RundeeItemFactory/src/Prompts/PromptBuilder.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">RundeeItemFactory<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">LLM-powered item generator for Unity &amp; Unreal Engine games</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('_prompt_builder_8cpp_source.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">PromptBuilder.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="_prompt_builder_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// ===============================</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">// Project Name: RundeeItemFactory</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// File Name: PromptBuilder.cpp</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">// Author: Haneul Lee (Rundee)</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">// Created Date: 2025-11-15</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">// Description: Implementation of prompt building for LLM.</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">// ===============================</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">// Copyright (c) 2025 Haneul Lee. All rights reserved.</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">// ===============================</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &quot;<a class="code" href="_prompt_builder_8h.html">Prompts/PromptBuilder.h</a>&quot;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &quot;<a class="code" href="_custom_preset_8h.html">Prompts/CustomPreset.h</a>&quot;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &quot;<a class="code" href="_prompt_template_loader_8h.html">Prompts/PromptTemplateLoader.h</a>&quot;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &lt;set&gt;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;cctype&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span> </div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="keyword">namespace</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>{</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span>    std::string GetPresetNameString(<a class="code hl_enumeration" href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52c">PresetType</a> preset)</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>    {</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span>        <span class="keywordflow">switch</span> (preset)</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>        {</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52caac12ee4aedb176eb73ce3f6c0d1e9036">PresetType::Forest</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;Forest&quot;</span>;</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52ca000c016d34ff41e245b69c67f22c83ff">PresetType::Desert</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;Desert&quot;</span>;</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52ca44f027304a424f444963d27ad46da394">PresetType::Coast</a>:  <span class="keywordflow">return</span> <span class="stringliteral">&quot;Coast&quot;</span>;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52ca57d056ed0984166336b7879c2af3657f">PresetType::City</a>:   <span class="keywordflow">return</span> <span class="stringliteral">&quot;City&quot;</span>;</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52ca7a1920d61156abc05a60135aefe8bc67">PresetType::Default</a>:</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>            <span class="keywordflow">return</span> <span class="stringliteral">&quot;Default&quot;</span>;</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>        }</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>    }</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span> </div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>    std::string ToSlug(<span class="keyword">const</span> std::string&amp; value, <span class="keyword">const</span> std::string&amp; fallback = <span class="stringliteral">&quot;default&quot;</span>)</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>    {</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>        std::string slug;</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>        slug.reserve(value.size());</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>        <span class="keywordtype">bool</span> lastWasUnderscore = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>        <span class="keywordflow">for</span> (<span class="keywordtype">char</span> c : value)</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>        {</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> uc = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">char</span><span class="keyword">&gt;</span>(c);</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>            <span class="keywordflow">if</span> (std::isalnum(uc))</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>            {</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>                slug += <span class="keyword">static_cast&lt;</span><span class="keywordtype">char</span><span class="keyword">&gt;</span>(std::tolower(uc));</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>                lastWasUnderscore = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>            }</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c == <span class="charliteral">&#39; &#39;</span> || c == <span class="charliteral">&#39;-&#39;</span> || c == <span class="charliteral">&#39;_&#39;</span> || c == <span class="charliteral">&#39;.&#39;</span>)</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>            {</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>                <span class="keywordflow">if</span> (!lastWasUnderscore)</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>                {</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>                    slug += <span class="charliteral">&#39;_&#39;</span>;</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>                    lastWasUnderscore = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>                }</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>            }</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>        }</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>        <span class="keywordflow">if</span> (!slug.empty() &amp;&amp; slug.back() == <span class="charliteral">&#39;_&#39;</span>)</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>        {</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>            slug.pop_back();</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>        }</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>        <span class="keywordflow">if</span> (slug.empty())</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>        {</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>            slug = fallback;</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>        }</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>        <span class="keywordflow">return</span> slug;</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    }</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span> </div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    std::string BuildExcludeSection(<span class="keyword">const</span> std::set&lt;std::string&gt;&amp; excludeIds)</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    {</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>        <span class="keywordflow">if</span> (excludeIds.empty())</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>            <span class="keywordflow">return</span> {};</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>        std::string text;</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>        text += <span class="stringliteral">&quot;\nIMPORTANT - Avoid these existing item IDs (do NOT use these):\n&quot;</span>;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>        <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> kMaxList = 40;</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <span class="keywordtype">id</span> : excludeIds)</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>        {</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>            <span class="keywordflow">if</span> (count &gt; 0) text += <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>            text += id;</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>            count++;</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>            <span class="keywordflow">if</span> (count &gt;= kMaxList)</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>            {</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>                text += <span class="stringliteral">&quot; ... (and &quot;</span> + std::to_string(excludeIds.size() - kMaxList) + <span class="stringliteral">&quot; more, list truncated)&quot;</span>;</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>            }</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>        }</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>        text += <span class="stringliteral">&quot;\nGenerate NEW unique IDs that are different from all existing IDs (assume many more exist). Avoid reusing stems; use fresh, novel names, not simple number suffixes.\n&quot;</span>;</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>        text += <span class="stringliteral">&quot;Do NOT generate items that are near-duplicates in concept or function of anything above or of each other in the same batch. Each item must have a distinct idea/material/purpose, not just small adjective changes. If a concept is already present (e.g., magazine extension, muzzle brake), pick a different component/design.\n&quot;</span>;</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>        text += <span class="stringliteral">&quot;For magazines: always include caliber and magazineType, and capacity must be realistic (10-60). Do NOT output capacity=1.\n&quot;</span>;</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>        <span class="keywordflow">return</span> text;</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>    }</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span> </div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>    std::string TryLoadTemplateWithFallback(</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>        <span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; templateNames,</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>        <span class="keyword">const</span> std::string&amp; presetContext,</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>        <span class="keyword">const</span> <a class="code hl_struct" href="struct_food_generate_params.html">FoodGenerateParams</a>&amp; params,</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>        <span class="keyword">const</span> std::set&lt;std::string&gt;&amp; excludeIds,</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>        <span class="keyword">const</span> std::string&amp; presetName,</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>        <span class="keyword">const</span> std::string&amp; itemTypeDisplayName,</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>        <span class="keyword">const</span> std::string&amp; modelName,</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>        <span class="keyword">const</span> std::string&amp; generationTimestamp,</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>        <span class="keywordtype">int</span> existingCount)</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>    {</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : templateNames)</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>        {</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>            <span class="keyword">auto</span> candidate = <a class="code hl_function" href="class_prompt_template_loader.html#add8e4ac7fd227f55959fe0e4fefc0652">PromptTemplateLoader::LoadTemplate</a>(</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>                name,</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>                presetContext,</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>                params.<a class="code hl_variable" href="struct_food_generate_params.html#aab329af04e5297b3b3867bc01ac00f64">maxHunger</a>,</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>                params.<a class="code hl_variable" href="struct_food_generate_params.html#a0c2d76f873e095ddde37c8d4932af2c7">maxThirst</a>,</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>                params.<a class="code hl_variable" href="struct_food_generate_params.html#a7254056f520c27e1852d50ef8df32203">count</a>,</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>                excludeIds,</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>                presetName,</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>                itemTypeDisplayName,</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>                modelName,</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>                generationTimestamp,</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>                existingCount);</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>            <span class="keywordflow">if</span> (!candidate.empty())</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>            {</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>                <span class="keywordflow">return</span> candidate;</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>            }</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>        }</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>        <span class="keywordflow">return</span> {};</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>    }</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>}</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span> </div>
<div class="foldopen" id="foldopen00128" data-start="{" data-end="}">
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno"><a class="line" href="class_prompt_builder.html#add1bfe5a2fd49bd2b2ddef2d29a1b5de">  128</a></span>std::string <a class="code hl_function" href="class_prompt_builder.html#add1bfe5a2fd49bd2b2ddef2d29a1b5de">PromptBuilder::GetPresetFlavorText</a>(<a class="code hl_enumeration" href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52c">PresetType</a> preset)</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>{</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>    <span class="keywordflow">switch</span> (preset)</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    {</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52caac12ee4aedb176eb73ce3f6c0d1e9036">PresetType::Forest</a>:</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>        <span class="keywordflow">return</span></div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>            <span class="stringliteral">&quot;World context:\n&quot;</span></div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>            <span class="stringliteral">&quot;- The setting is a temperate forest with plenty of bushes, mushrooms, and small animals.\n&quot;</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>            <span class="stringliteral">&quot;- Early-game items should focus on berries, nuts, roots, and simple cooked meals.\n&quot;</span></div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>            <span class="stringliteral">&quot;- Water sources are streams and rainwater.\n\n&quot;</span>;</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span> </div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52ca000c016d34ff41e245b69c67f22c83ff">PresetType::Desert</a>:</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>        <span class="keywordflow">return</span></div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>            <span class="stringliteral">&quot;World context:\n&quot;</span></div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>            <span class="stringliteral">&quot;- The setting is a harsh desert with scarce vegetation and limited water.\n&quot;</span></div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>            <span class="stringliteral">&quot;- Food items should be low in quantity but efficient, like dried meat or cactus fruit.\n&quot;</span></div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>            <span class="stringliteral">&quot;- Drinks are highly valuable and restore more thirst.\n&quot;</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>            <span class="stringliteral">&quot;- Emphasize scarcity and survival under heat.\n\n&quot;</span>;</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span> </div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52ca44f027304a424f444963d27ad46da394">PresetType::Coast</a>:</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>        <span class="keywordflow">return</span></div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>            <span class="stringliteral">&quot;World context:\n&quot;</span></div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>            <span class="stringliteral">&quot;- The setting is a coastal island with beaches, palm trees, and shallow seawater.\n&quot;</span></div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>            <span class="stringliteral">&quot;- Food comes from coconuts, fish, shellfish, and tropical fruits.\n&quot;</span></div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>            <span class="stringliteral">&quot;- Drinks are mainly coconut water or boiled water.\n&quot;</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>            <span class="stringliteral">&quot;- Slightly higher thirst restoration for drinks.\n\n&quot;</span>;</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span> </div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52ca57d056ed0984166336b7879c2af3657f">PresetType::City</a>:</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>        <span class="keywordflow">return</span></div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>            <span class="stringliteral">&quot;World context:\n&quot;</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>            <span class="stringliteral">&quot;- The setting is an abandoned modern city with convenience stores, vending machines, and supermarkets.\n&quot;</span></div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>            <span class="stringliteral">&quot;- Most food is processed: canned food, instant noodles, snacks, and energy bars.\n&quot;</span></div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>            <span class="stringliteral">&quot;- Drinks are bottled water, soft drinks, and energy drinks with higher thirst restoration.\n&quot;</span></div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>            <span class="stringliteral">&quot;- Many items do not spoil quickly, but some fresh food can still be found.\n\n&quot;</span>;</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span> </div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52ca7a1920d61156abc05a60135aefe8bc67">PresetType::Default</a>:</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>        <span class="keywordflow">return</span></div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>            <span class="stringliteral">&quot;World context:\n&quot;</span></div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>            <span class="stringliteral">&quot;- Generic early-game survival environment with moderate resources.\n&quot;</span></div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>            <span class="stringliteral">&quot;- Items should feel simple and grounded, not magical or high-tech.\n\n&quot;</span>;</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>    }</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>}</div>
</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span> </div>
<div class="foldopen" id="foldopen00172" data-start="{" data-end="}">
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno"><a class="line" href="class_prompt_builder.html#aa8f1bb33dbd6e9b9dd978c13148b6e75">  172</a></span>std::string <a class="code hl_function" href="class_prompt_builder.html#add1bfe5a2fd49bd2b2ddef2d29a1b5de">PromptBuilder::GetPresetFlavorText</a>(<span class="keyword">const</span> <a class="code hl_struct" href="struct_custom_preset.html">CustomPreset</a>&amp; customPreset)</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>{</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespace_custom_preset_manager.html#ac7bd53ae26d97a50620737c3abb4f3a4">CustomPresetManager::GetPresetFlavorText</a>(customPreset);</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>}</div>
</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span> </div>
<div class="foldopen" id="foldopen00177" data-start="{" data-end="}">
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno"><a class="line" href="class_prompt_builder.html#a4dbbfeb85017a5b3692757587170ee1c">  177</a></span>std::string <a class="code hl_function" href="class_prompt_builder.html#a4dbbfeb85017a5b3692757587170ee1c">PromptBuilder::BuildFoodJsonPrompt</a>(<span class="keyword">const</span> <a class="code hl_struct" href="struct_food_generate_params.html">FoodGenerateParams</a>&amp; params,</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>                                               <a class="code hl_enumeration" href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52c">PresetType</a> preset,</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>                                               <span class="keyword">const</span> std::set&lt;std::string&gt;&amp; excludeIds,</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>                                               <span class="keyword">const</span> std::string&amp; modelName,</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>                                               <span class="keyword">const</span> std::string&amp; generationTimestamp,</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>                                               <span class="keywordtype">int</span> existingCount)</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>{</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>    <span class="comment">// Try to load from template file first</span></div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    std::string presetContext = <a class="code hl_function" href="class_prompt_builder.html#add1bfe5a2fd49bd2b2ddef2d29a1b5de">GetPresetFlavorText</a>(preset);</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    std::string presetName = GetPresetNameString(preset);</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    std::string presetSlug = ToSlug(presetName);</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span> </div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>    std::vector&lt;std::string&gt; templateCandidates =</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    {</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>        <span class="stringliteral">&quot;food_&quot;</span> + presetSlug,</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>        <span class="stringliteral">&quot;food&quot;</span></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    };</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span> </div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>    std::string templatePrompt = TryLoadTemplateWithFallback(</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>        templateCandidates,</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>        presetContext,</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>        params,</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>        excludeIds,</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>        presetName,</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>        <span class="stringliteral">&quot;Food&quot;</span>,</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>        modelName,</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>        generationTimestamp,</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>        existingCount);</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    </div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>    <span class="keywordflow">if</span> (!templatePrompt.empty())</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>    {</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>        <span class="keywordflow">return</span> templatePrompt; <span class="comment">// Use template file</span></div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>    }</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span> </div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    <span class="comment">// Fall back to hardcoded prompt if template not found</span></div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    std::string prompt;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span> </div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>    <span class="comment">// 1) Add preset world context</span></div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>    prompt += presetContext;</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span> </div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>    <span class="comment">// 2) Describe player parameters</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    prompt += <span class="stringliteral">&quot;The player has:\n&quot;</span>;</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>    prompt += <span class="stringliteral">&quot;- maxHunger = &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#aab329af04e5297b3b3867bc01ac00f64">maxHunger</a>) + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>    prompt += <span class="stringliteral">&quot;- maxThirst = &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#a0c2d76f873e095ddde37c8d4932af2c7">maxThirst</a>) + <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>    <span class="comment">// 3) Task description</span></div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    prompt += <span class="stringliteral">&quot;Task:\n&quot;</span>;</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>    prompt += <span class="stringliteral">&quot;Generate &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#a7254056f520c27e1852d50ef8df32203">count</a>) + <span class="stringliteral">&quot; food-related items &quot;</span>;</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    prompt += <span class="stringliteral">&quot;for an early-game survival setting.\n&quot;</span>;</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    </div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    <span class="comment">// Add exclusion list if provided</span></div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    prompt += BuildExcludeSection(excludeIds);</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span> </div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>    <span class="comment">// 4) Define JSON Rules/Schema/Output text here and output as-is</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    prompt += <span class="stringliteral">&quot;Rules:\n&quot;</span>;</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    prompt += <span class="stringliteral">&quot;- Use this JSON schema EXACTLY for each item:\n&quot;</span>;</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    prompt += <span class="stringliteral">&quot;{\n&quot;</span>;</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    prompt += <span class="stringliteral">&quot;  \&quot;id\&quot;: string (unique, lowercase, underscore),\n&quot;</span>;</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>    prompt += <span class="stringliteral">&quot;  \&quot;displayName\&quot;: string,\n&quot;</span>;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>    prompt += <span class="stringliteral">&quot;  \&quot;category\&quot;: \&quot;Food\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    prompt += <span class="stringliteral">&quot;  \&quot;rarity\&quot;: \&quot;Common\&quot; | \&quot;Uncommon\&quot; | \&quot;Rare\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    prompt += <span class="stringliteral">&quot;  \&quot;maxStack\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    prompt += <span class="stringliteral">&quot;  \&quot;hungerRestore\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>    prompt += <span class="stringliteral">&quot;  \&quot;thirstRestore\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>    prompt += <span class="stringliteral">&quot;  \&quot;healthRestore\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    prompt += <span class="stringliteral">&quot;  \&quot;spoils\&quot;: boolean,\n&quot;</span>;</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    prompt += <span class="stringliteral">&quot;  \&quot;spoilTimeMinutes\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>    prompt += <span class="stringliteral">&quot;  \&quot;description\&quot;: string\n&quot;</span>;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    prompt += <span class="stringliteral">&quot;}\n&quot;</span>;</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>    prompt += <span class="stringliteral">&quot;IMPORTANT:\n&quot;</span>;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>    prompt += <span class="stringliteral">&quot;- category MUST be \&quot;Food\&quot; (NOT \&quot;Drink\&quot;).\n&quot;</span>;</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>    prompt += <span class="stringliteral">&quot;- Generate ONLY food items, not drinks.\n&quot;</span>;</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>    prompt += <span class="stringliteral">&quot;- description must NOT be empty and should be 1 short sentence (5-20 words)\n&quot;</span>;</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>    prompt += <span class="stringliteral">&quot;  that describes what the food looks like and its taste.\n&quot;</span>;</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>    prompt += <span class="stringliteral">&quot;Balancing:\n&quot;</span>;</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>    prompt += <span class="stringliteral">&quot;- Snacks: hungerRestore 5-15, thirstRestore 0-5\n&quot;</span>;</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>    prompt += <span class="stringliteral">&quot;- Light meals: hungerRestore 15-30, thirstRestore 0-10\n&quot;</span>;</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>    prompt += <span class="stringliteral">&quot;- Heavy meals: hungerRestore 30-50, thirstRestore 0-10\n&quot;</span>;</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    prompt += <span class="stringliteral">&quot;- All values must be between 0 and 100.\n&quot;</span>;</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>    prompt += <span class="stringliteral">&quot;- Use only integers for all restore values.\n&quot;</span>;</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>    prompt += <span class="stringliteral">&quot;Output:\n&quot;</span>;</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>    prompt += <span class="stringliteral">&quot;- Output ONLY a JSON array of items.\n&quot;</span>;</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>    prompt += <span class="stringliteral">&quot;- No comments, no extra text, no Markdown, no explanation.\n&quot;</span>;</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span> </div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>    <span class="keywordflow">return</span> prompt;</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>}</div>
</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span> </div>
<div class="foldopen" id="foldopen00271" data-start="{" data-end="}">
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno"><a class="line" href="class_prompt_builder.html#afe0067d892f157d55b58de9e7476533a">  271</a></span>std::string <a class="code hl_function" href="class_prompt_builder.html#a4dbbfeb85017a5b3692757587170ee1c">PromptBuilder::BuildFoodJsonPrompt</a>(<span class="keyword">const</span> <a class="code hl_struct" href="struct_food_generate_params.html">FoodGenerateParams</a>&amp; params,</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>                                               <span class="keyword">const</span> <a class="code hl_struct" href="struct_custom_preset.html">CustomPreset</a>&amp; customPreset,</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>                                               <span class="keyword">const</span> std::set&lt;std::string&gt;&amp; excludeIds,</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>                                               <span class="keyword">const</span> std::string&amp; modelName,</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>                                               <span class="keyword">const</span> std::string&amp; generationTimestamp,</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>                                               <span class="keywordtype">int</span> existingCount)</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>{</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    <span class="comment">// Try to load from template file first</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    std::string presetContext = <a class="code hl_function" href="class_prompt_builder.html#add1bfe5a2fd49bd2b2ddef2d29a1b5de">GetPresetFlavorText</a>(customPreset);</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>    std::string presetName = customPreset.<a class="code hl_variable" href="struct_custom_preset.html#a7169ba2db551ca89884436475926e982">displayName</a>.empty() ? customPreset.<a class="code hl_variable" href="struct_custom_preset.html#aac31fc92ad757067de5661c3270ec54c">id</a> : customPreset.<a class="code hl_variable" href="struct_custom_preset.html#a7169ba2db551ca89884436475926e982">displayName</a>;</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>    std::string presetSlug = ToSlug(presetName);</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span> </div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>    std::vector&lt;std::string&gt; templateCandidates =</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>    {</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>        <span class="stringliteral">&quot;food_custom_&quot;</span> + presetSlug,</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>        <span class="stringliteral">&quot;food_&quot;</span> + presetSlug,</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>        <span class="stringliteral">&quot;food&quot;</span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>    };</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>    std::string templatePrompt = TryLoadTemplateWithFallback(</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>        templateCandidates,</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>        presetContext,</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>        params,</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>        excludeIds,</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>        presetName,</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>        <span class="stringliteral">&quot;Food&quot;</span>,</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>        modelName,</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>        generationTimestamp,</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>        existingCount);</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>    </div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>    <span class="keywordflow">if</span> (!templatePrompt.empty())</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>    {</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>        <span class="keywordflow">return</span> templatePrompt; <span class="comment">// Use template file</span></div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    }</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span> </div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    <span class="comment">// Fall back to hardcoded prompt if template not found</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>    std::string prompt;</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span> </div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>    <span class="comment">// 1) Add preset world context</span></div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>    prompt += presetContext;</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span> </div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>    <span class="comment">// 2) Describe player parameters</span></div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>    prompt += <span class="stringliteral">&quot;The player has:\n&quot;</span>;</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>    prompt += <span class="stringliteral">&quot;- maxHunger = &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#aab329af04e5297b3b3867bc01ac00f64">maxHunger</a>) + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>    prompt += <span class="stringliteral">&quot;- maxThirst = &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#a0c2d76f873e095ddde37c8d4932af2c7">maxThirst</a>) + <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span> </div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>    <span class="comment">// 3) Task description</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>    prompt += <span class="stringliteral">&quot;Task:\n&quot;</span>;</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>    prompt += <span class="stringliteral">&quot;Generate &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#a7254056f520c27e1852d50ef8df32203">count</a>) + <span class="stringliteral">&quot; food-related items &quot;</span>;</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>    prompt += <span class="stringliteral">&quot;for an early-game survival setting.\n&quot;</span>;</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>    </div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>    <span class="comment">// Add exclusion list if provided</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>    prompt += BuildExcludeSection(excludeIds);</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span> </div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>    <span class="comment">// 4) Define JSON Rules/Schema/Output text here and output as-is</span></div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>    prompt += <span class="stringliteral">&quot;Rules:\n&quot;</span>;</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>    prompt += <span class="stringliteral">&quot;- Use this JSON schema EXACTLY for each item:\n&quot;</span>;</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>    prompt += <span class="stringliteral">&quot;{\n&quot;</span>;</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>    prompt += <span class="stringliteral">&quot;  \&quot;id\&quot;: string (unique, lowercase, underscore),\n&quot;</span>;</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>    prompt += <span class="stringliteral">&quot;  \&quot;displayName\&quot;: string,\n&quot;</span>;</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    prompt += <span class="stringliteral">&quot;  \&quot;category\&quot;: \&quot;Food\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>    prompt += <span class="stringliteral">&quot;  \&quot;rarity\&quot;: \&quot;Common\&quot; | \&quot;Uncommon\&quot; | \&quot;Rare\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    prompt += <span class="stringliteral">&quot;  \&quot;maxStack\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    prompt += <span class="stringliteral">&quot;  \&quot;hungerRestore\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>    prompt += <span class="stringliteral">&quot;  \&quot;thirstRestore\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>    prompt += <span class="stringliteral">&quot;  \&quot;healthRestore\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>    prompt += <span class="stringliteral">&quot;  \&quot;spoils\&quot;: boolean,\n&quot;</span>;</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>    prompt += <span class="stringliteral">&quot;  \&quot;spoilTimeMinutes\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>    prompt += <span class="stringliteral">&quot;  \&quot;description\&quot;: string\n&quot;</span>;</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>    prompt += <span class="stringliteral">&quot;}\n&quot;</span>;</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>    prompt += <span class="stringliteral">&quot;Balancing rules:\n&quot;</span>;</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>    prompt += <span class="stringliteral">&quot;- Common items: hungerRestore 5-25, thirstRestore 0-10, healthRestore 0-5.\n&quot;</span>;</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>    prompt += <span class="stringliteral">&quot;- Uncommon items: hungerRestore 20-40, thirstRestore 5-15, healthRestore 0-10.\n&quot;</span>;</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>    prompt += <span class="stringliteral">&quot;- Rare items: hungerRestore 35-60, thirstRestore 10-25, healthRestore 5-20.\n&quot;</span>;</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>    prompt += <span class="stringliteral">&quot;- Total power (hunger + thirst + health) should not exceed 80 for Common, 100 for Uncommon, 120 for Rare.\n&quot;</span>;</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    prompt += <span class="stringliteral">&quot;- Items that spoil should have spoilTimeMinutes between 30 and 720 (30 minutes to 12 hours).\n&quot;</span>;</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>    prompt += <span class="stringliteral">&quot;Output:\n&quot;</span>;</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>    prompt += <span class="stringliteral">&quot;- Output ONLY a JSON array of items.\n&quot;</span>;</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>    prompt += <span class="stringliteral">&quot;- No comments, no extra text, no Markdown, no explanation.\n&quot;</span>;</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span> </div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>    <span class="keywordflow">return</span> prompt;</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>}</div>
</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span> </div>
<div class="foldopen" id="foldopen00360" data-start="{" data-end="}">
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno"><a class="line" href="class_prompt_builder.html#af573636eb2d4440020edd5d56bcbceb7">  360</a></span>std::string <a class="code hl_function" href="class_prompt_builder.html#af573636eb2d4440020edd5d56bcbceb7">PromptBuilder::BuildDrinkJsonPrompt</a>(<span class="keyword">const</span> <a class="code hl_struct" href="struct_food_generate_params.html">FoodGenerateParams</a>&amp; params,</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>                                                <a class="code hl_enumeration" href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52c">PresetType</a> preset,</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>                                                <span class="keyword">const</span> std::set&lt;std::string&gt;&amp; excludeIds,</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>                                                <span class="keyword">const</span> std::string&amp; modelName,</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>                                                <span class="keyword">const</span> std::string&amp; generationTimestamp,</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>                                                <span class="keywordtype">int</span> existingCount)</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>{</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>    std::string presetContext = <a class="code hl_function" href="class_prompt_builder.html#add1bfe5a2fd49bd2b2ddef2d29a1b5de">GetPresetFlavorText</a>(preset);</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>    std::string presetName = GetPresetNameString(preset);</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>    std::string presetSlug = ToSlug(presetName);</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span> </div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>    std::vector&lt;std::string&gt; templateCandidates =</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>    {</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>        <span class="stringliteral">&quot;drink_&quot;</span> + presetSlug,</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>        <span class="stringliteral">&quot;drink&quot;</span></div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>    };</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span> </div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>    std::string templatePrompt = TryLoadTemplateWithFallback(</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>        templateCandidates,</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>        presetContext,</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>        params,</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>        excludeIds,</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>        presetName,</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>        <span class="stringliteral">&quot;Drink&quot;</span>,</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>        modelName,</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>        generationTimestamp,</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>        existingCount);</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>    <span class="keywordflow">if</span> (!templatePrompt.empty())</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>    {</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>        <span class="keywordflow">return</span> templatePrompt;</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>    }</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span> </div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>    std::string prompt;</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span> </div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>    <span class="comment">// 1) Add preset world context</span></div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>    prompt += presetContext;</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span> </div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>    <span class="comment">// 2) Describe player parameters</span></div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>    prompt += <span class="stringliteral">&quot;The player has:\n&quot;</span>;</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>    prompt += <span class="stringliteral">&quot;- maxHunger = &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#aab329af04e5297b3b3867bc01ac00f64">maxHunger</a>) + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>    prompt += <span class="stringliteral">&quot;- maxThirst = &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#a0c2d76f873e095ddde37c8d4932af2c7">maxThirst</a>) + <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span> </div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>    <span class="comment">// 3) Task description</span></div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>    prompt += <span class="stringliteral">&quot;Task:\n&quot;</span>;</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>    prompt += <span class="stringliteral">&quot;Generate &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#a7254056f520c27e1852d50ef8df32203">count</a>) + <span class="stringliteral">&quot; drink-related items &quot;</span>;</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>    prompt += <span class="stringliteral">&quot;for an early-game survival setting.\n&quot;</span>;</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>    </div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>    <span class="comment">// Add exclusion list if provided</span></div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>    prompt += BuildExcludeSection(excludeIds);</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span> </div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>    <span class="comment">// 4) JSON Rules/Schema/Output text</span></div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>    prompt += <span class="stringliteral">&quot;Rules:\n&quot;</span>;</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>    prompt += <span class="stringliteral">&quot;- Use this JSON schema EXACTLY for each item:\n&quot;</span>;</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>    prompt += <span class="stringliteral">&quot;{\n&quot;</span>;</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    prompt += <span class="stringliteral">&quot;  \&quot;id\&quot;: string (unique, lowercase, underscore),\n&quot;</span>;</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>    prompt += <span class="stringliteral">&quot;  \&quot;displayName\&quot;: string,\n&quot;</span>;</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>    prompt += <span class="stringliteral">&quot;  \&quot;category\&quot;: \&quot;Drink\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>    prompt += <span class="stringliteral">&quot;  \&quot;rarity\&quot;: \&quot;Common\&quot; | \&quot;Uncommon\&quot; | \&quot;Rare\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>    prompt += <span class="stringliteral">&quot;  \&quot;maxStack\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>    prompt += <span class="stringliteral">&quot;  \&quot;hungerRestore\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>    prompt += <span class="stringliteral">&quot;  \&quot;thirstRestore\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>    prompt += <span class="stringliteral">&quot;  \&quot;healthRestore\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>    prompt += <span class="stringliteral">&quot;  \&quot;spoils\&quot;: boolean,\n&quot;</span>;</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>    prompt += <span class="stringliteral">&quot;  \&quot;spoilTimeMinutes\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>    prompt += <span class="stringliteral">&quot;  \&quot;description\&quot;: string\n&quot;</span>;</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>    prompt += <span class="stringliteral">&quot;}\n&quot;</span>;</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>    prompt += <span class="stringliteral">&quot;IMPORTANT:\n&quot;</span>;</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>    prompt += <span class="stringliteral">&quot;- category MUST be \&quot;Drink\&quot; (NOT \&quot;Food\&quot;).\n&quot;</span>;</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    prompt += <span class="stringliteral">&quot;- Generate ONLY drink items, not food.\n&quot;</span>;</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>    prompt += <span class="stringliteral">&quot;- description must NOT be empty and should be 1 short sentence (5-20 words)\n&quot;</span>;</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>    prompt += <span class="stringliteral">&quot;  that describes what the drink looks like and its taste.\n&quot;</span>;</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>    prompt += <span class="stringliteral">&quot;Balancing:\n&quot;</span>;</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>    prompt += <span class="stringliteral">&quot;- Drinks: hungerRestore 0-10, thirstRestore 15-40\n&quot;</span>;</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>    prompt += <span class="stringliteral">&quot;- Health drinks: thirstRestore 20-40, healthRestore 5-20\n&quot;</span>;</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    prompt += <span class="stringliteral">&quot;- All values must be between 0 and 100.\n&quot;</span>;</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    prompt += <span class="stringliteral">&quot;- Use only integers for all restore values.\n&quot;</span>;</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>    prompt += <span class="stringliteral">&quot;- thirstRestore should be higher than hungerRestore for drinks.\n&quot;</span>;</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>    prompt += <span class="stringliteral">&quot;Output:\n&quot;</span>;</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>    prompt += <span class="stringliteral">&quot;- Output ONLY a JSON array of items.\n&quot;</span>;</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>    prompt += <span class="stringliteral">&quot;- No comments, no extra text, no Markdown, no explanation.\n&quot;</span>;</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span> </div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>    <span class="keywordflow">return</span> prompt;</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>}</div>
</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span> </div>
<div class="foldopen" id="foldopen00451" data-start="{" data-end="}">
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno"><a class="line" href="class_prompt_builder.html#a4f1cd1654f392aee4fc652f356b29606">  451</a></span>std::string <a class="code hl_function" href="class_prompt_builder.html#af573636eb2d4440020edd5d56bcbceb7">PromptBuilder::BuildDrinkJsonPrompt</a>(<span class="keyword">const</span> <a class="code hl_struct" href="struct_food_generate_params.html">FoodGenerateParams</a>&amp; params,</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>                                                <span class="keyword">const</span> <a class="code hl_struct" href="struct_custom_preset.html">CustomPreset</a>&amp; customPreset,</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>                                                <span class="keyword">const</span> std::set&lt;std::string&gt;&amp; excludeIds,</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>                                                <span class="keyword">const</span> std::string&amp; modelName,</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>                                                <span class="keyword">const</span> std::string&amp; generationTimestamp,</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>                                                <span class="keywordtype">int</span> existingCount)</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>{</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>    std::string presetContext = <a class="code hl_function" href="class_prompt_builder.html#add1bfe5a2fd49bd2b2ddef2d29a1b5de">GetPresetFlavorText</a>(customPreset);</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>    std::string presetName = customPreset.<a class="code hl_variable" href="struct_custom_preset.html#a7169ba2db551ca89884436475926e982">displayName</a>.empty() ? customPreset.<a class="code hl_variable" href="struct_custom_preset.html#aac31fc92ad757067de5661c3270ec54c">id</a> : customPreset.<a class="code hl_variable" href="struct_custom_preset.html#a7169ba2db551ca89884436475926e982">displayName</a>;</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>    std::string presetSlug = ToSlug(presetName);</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span> </div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>    std::vector&lt;std::string&gt; templateCandidates =</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>    {</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>        <span class="stringliteral">&quot;drink_custom_&quot;</span> + presetSlug,</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>        <span class="stringliteral">&quot;drink_&quot;</span> + presetSlug,</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>        <span class="stringliteral">&quot;drink&quot;</span></div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>    };</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span> </div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>    std::string templatePrompt = TryLoadTemplateWithFallback(</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>        templateCandidates,</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>        presetContext,</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>        params,</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>        excludeIds,</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>        presetName,</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>        <span class="stringliteral">&quot;Drink&quot;</span>,</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>        modelName,</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>        generationTimestamp,</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>        existingCount);</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>    <span class="keywordflow">if</span> (!templatePrompt.empty())</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>    {</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>        <span class="keywordflow">return</span> templatePrompt;</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>    }</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span> </div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>    std::string prompt;</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>    prompt += presetContext;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>    prompt += <span class="stringliteral">&quot;The player has:\n&quot;</span>;</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>    prompt += <span class="stringliteral">&quot;- maxHunger = &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#aab329af04e5297b3b3867bc01ac00f64">maxHunger</a>) + <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>    prompt += <span class="stringliteral">&quot;- maxThirst = &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#a0c2d76f873e095ddde37c8d4932af2c7">maxThirst</a>) + <span class="stringliteral">&quot;\n\n&quot;</span>;</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>    prompt += <span class="stringliteral">&quot;Task:\n&quot;</span>;</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>    prompt += <span class="stringliteral">&quot;Generate &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#a7254056f520c27e1852d50ef8df32203">count</a>) + <span class="stringliteral">&quot; drink-related items &quot;</span>;</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>    prompt += <span class="stringliteral">&quot;for an early-game survival setting.\n&quot;</span>;</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>    prompt += BuildExcludeSection(excludeIds);</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>    prompt += <span class="stringliteral">&quot;Rules:\n&quot;</span>;</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>    prompt += <span class="stringliteral">&quot;- Use this JSON schema EXACTLY for each item:\n&quot;</span>;</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>    prompt += <span class="stringliteral">&quot;{\n&quot;</span>;</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>    prompt += <span class="stringliteral">&quot;  \&quot;id\&quot;: string (unique, lowercase, underscore),\n&quot;</span>;</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>    prompt += <span class="stringliteral">&quot;  \&quot;displayName\&quot;: string,\n&quot;</span>;</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>    prompt += <span class="stringliteral">&quot;  \&quot;category\&quot;: \&quot;Drink\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>    prompt += <span class="stringliteral">&quot;  \&quot;rarity\&quot;: \&quot;Common\&quot; | \&quot;Uncommon\&quot; | \&quot;Rare\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>    prompt += <span class="stringliteral">&quot;  \&quot;maxStack\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>    prompt += <span class="stringliteral">&quot;  \&quot;hungerRestore\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>    prompt += <span class="stringliteral">&quot;  \&quot;thirstRestore\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>    prompt += <span class="stringliteral">&quot;  \&quot;healthRestore\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>    prompt += <span class="stringliteral">&quot;  \&quot;spoils\&quot;: boolean,\n&quot;</span>;</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>    prompt += <span class="stringliteral">&quot;  \&quot;spoilTimeMinutes\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>    prompt += <span class="stringliteral">&quot;  \&quot;description\&quot;: string\n&quot;</span>;</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>    prompt += <span class="stringliteral">&quot;}\n&quot;</span>;</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>    prompt += <span class="stringliteral">&quot;Balancing rules:\n&quot;</span>;</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>    prompt += <span class="stringliteral">&quot;- Common items: hungerRestore 0-5, thirstRestore 10-30, healthRestore 0-5.\n&quot;</span>;</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>    prompt += <span class="stringliteral">&quot;- Uncommon items: hungerRestore 0-10, thirstRestore 25-50, healthRestore 0-10.\n&quot;</span>;</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>    prompt += <span class="stringliteral">&quot;- Rare items: hungerRestore 0-15, thirstRestore 40-70, healthRestore 5-20.\n&quot;</span>;</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>    prompt += <span class="stringliteral">&quot;- Total power (hunger + thirst + health) should not exceed 80 for Common, 100 for Uncommon, 120 for Rare.\n&quot;</span>;</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>    prompt += <span class="stringliteral">&quot;- Items that spoil should have spoilTimeMinutes between 30 and 720.\n&quot;</span>;</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>    prompt += <span class="stringliteral">&quot;- Use only integers for all restore values.\n&quot;</span>;</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>    prompt += <span class="stringliteral">&quot;- thirstRestore should be higher than hungerRestore for drinks.\n&quot;</span>;</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>    prompt += <span class="stringliteral">&quot;Output:\n&quot;</span>;</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>    prompt += <span class="stringliteral">&quot;- Output ONLY a JSON array of items.\n&quot;</span>;</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>    prompt += <span class="stringliteral">&quot;- No comments, no extra text, no Markdown, no explanation.\n&quot;</span>;</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>    <span class="keywordflow">return</span> prompt;</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>}</div>
</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span> </div>
<div class="foldopen" id="foldopen00528" data-start="{" data-end="}">
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno"><a class="line" href="class_prompt_builder.html#ad764c13df10dd52e205dbb7cc4901c8b">  528</a></span>std::string <a class="code hl_function" href="class_prompt_builder.html#ad764c13df10dd52e205dbb7cc4901c8b">PromptBuilder::BuildMaterialJsonPrompt</a>(<span class="keyword">const</span> <a class="code hl_struct" href="struct_food_generate_params.html">FoodGenerateParams</a>&amp; params,</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>                                                   <a class="code hl_enumeration" href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52c">PresetType</a> preset,</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>                                                   <span class="keyword">const</span> std::set&lt;std::string&gt;&amp; excludeIds,</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>                                                   <span class="keyword">const</span> std::string&amp; modelName,</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>                                                   <span class="keyword">const</span> std::string&amp; generationTimestamp,</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>                                                   <span class="keywordtype">int</span> existingCount)</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>{</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>    std::string presetContext = <a class="code hl_function" href="class_prompt_builder.html#add1bfe5a2fd49bd2b2ddef2d29a1b5de">GetPresetFlavorText</a>(preset);</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>    std::string presetName = GetPresetNameString(preset);</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>    std::string presetSlug = ToSlug(presetName);</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span> </div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>    std::vector&lt;std::string&gt; templateCandidates =</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>    {</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>        <span class="stringliteral">&quot;material_&quot;</span> + presetSlug,</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>        <span class="stringliteral">&quot;material&quot;</span></div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>    };</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span> </div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>    std::string templatePrompt = TryLoadTemplateWithFallback(</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>        templateCandidates,</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>        presetContext,</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>        params,</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>        excludeIds,</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>        presetName,</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>        <span class="stringliteral">&quot;Material&quot;</span>,</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>        modelName,</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>        generationTimestamp,</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>        existingCount);</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>    <span class="keywordflow">if</span> (!templatePrompt.empty())</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>    {</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>        <span class="keywordflow">return</span> templatePrompt;</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>    }</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span> </div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>    std::string prompt;</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span> </div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>    <span class="comment">// 1) Add preset world context</span></div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>    prompt += presetContext;</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span> </div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>    <span class="comment">// 2) Task description</span></div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>    prompt += <span class="stringliteral">&quot;Task:\n&quot;</span>;</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>    prompt += <span class="stringliteral">&quot;Generate &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#a7254056f520c27e1852d50ef8df32203">count</a>) + <span class="stringliteral">&quot; crafting materials and junk items &quot;</span>;</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>    prompt += <span class="stringliteral">&quot;for this survival setting.\n\n&quot;</span>;</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span> </div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>    <span class="comment">// 3) Define schema / rules</span></div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>    prompt += <span class="stringliteral">&quot;Item type:\n&quot;</span>;</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>    prompt += <span class="stringliteral">&quot;- These items are used for crafting, building, or scrapping.\n&quot;</span>;</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>    prompt += <span class="stringliteral">&quot;- Do NOT create food, drink, weapons, or medicine in this preset.\n&quot;</span>;</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>    prompt += <span class="stringliteral">&quot;- Focus on materials like wood planks, scrap metal, nails, screws, springs, electronic boards, wires, cloth, etc.\n&quot;</span>;</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>    prompt += <span class="stringliteral">&quot;Use this JSON schema EXACTLY for each item:\n&quot;</span>;</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>    prompt += <span class="stringliteral">&quot;{\n&quot;</span>;</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>    prompt += <span class="stringliteral">&quot;  \&quot;id\&quot;: string (unique, lowercase, underscore),\n&quot;</span>;</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>    prompt += <span class="stringliteral">&quot;  \&quot;displayName\&quot;: string,\n&quot;</span>;</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>    prompt += <span class="stringliteral">&quot;  \&quot;category\&quot;: \&quot;Material\&quot; | \&quot;Junk\&quot; | \&quot;Component\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>    prompt += <span class="stringliteral">&quot;  \&quot;rarity\&quot;: \&quot;Common\&quot; | \&quot;Uncommon\&quot; | \&quot;Rare\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>    prompt += <span class="stringliteral">&quot;  \&quot;maxStack\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>    prompt += <span class="stringliteral">&quot;  \&quot;materialType\&quot;: \&quot;Wood\&quot; | \&quot;Metal\&quot; | \&quot;Plastic\&quot; | \&quot;Fabric\&quot; | \&quot;Glass\&quot; | \&quot;Electronic\&quot; | \&quot;Stone\&quot; | \&quot;Rubber\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>    prompt += <span class="stringliteral">&quot;  \&quot;hardness\&quot;: integer,      // 0-100, structural strength\n&quot;</span>;</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>    prompt += <span class="stringliteral">&quot;  \&quot;flammability\&quot;: integer,  // 0-100, how well it burns\n&quot;</span>;</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>    prompt += <span class="stringliteral">&quot;  \&quot;value\&quot;: integer,         // 0-100, scrap/trade value\n&quot;</span>;</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>    prompt += <span class="stringliteral">&quot;  \&quot;description\&quot;: string\n&quot;</span>;</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>    prompt += <span class="stringliteral">&quot;}\n&quot;</span>;</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>    prompt += <span class="stringliteral">&quot;Balancing rules:\n&quot;</span>;</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>    prompt += <span class="stringliteral">&quot;- Common items: low to medium value (value 5-40), simple materials.\n&quot;</span>;</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>    prompt += <span class="stringliteral">&quot;- Uncommon items: better structural stats or higher value (value 25-70).\n&quot;</span>;</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>    prompt += <span class="stringliteral">&quot;- Rare items: high value or very useful components (value 50-100).\n&quot;</span>;</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>    prompt += <span class="stringliteral">&quot;- hardness, flammability, and value must all be in the range 0-100.\n&quot;</span>;</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>    prompt += <span class="stringliteral">&quot;- maxStack should be between 1 and 100.\n&quot;</span>;</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>    prompt += <span class="stringliteral">&quot;- description must NOT be empty and should be 1 short sentence (5-20 words)\n&quot;</span>;</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>    prompt += <span class="stringliteral">&quot;  that explains what the item looks like and how it is used.\n&quot;</span>;</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>    prompt += <span class="stringliteral">&quot;Output:\n&quot;</span>;</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>    prompt += <span class="stringliteral">&quot;- Output ONLY a JSON array of items.\n&quot;</span>;</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>    prompt += <span class="stringliteral">&quot;- No comments, no extra text, no Markdown, no explanation.\n&quot;</span>;</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span> </div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>    <span class="keywordflow">return</span> prompt;</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>}</div>
</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span> </div>
<div class="foldopen" id="foldopen00610" data-start="{" data-end="}">
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno"><a class="line" href="class_prompt_builder.html#a1dc224aa11da8f0102d10759c30fae15">  610</a></span>std::string <a class="code hl_function" href="class_prompt_builder.html#ad764c13df10dd52e205dbb7cc4901c8b">PromptBuilder::BuildMaterialJsonPrompt</a>(<span class="keyword">const</span> <a class="code hl_struct" href="struct_food_generate_params.html">FoodGenerateParams</a>&amp; params,</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>                                                   <span class="keyword">const</span> <a class="code hl_struct" href="struct_custom_preset.html">CustomPreset</a>&amp; customPreset,</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>                                                   <span class="keyword">const</span> std::set&lt;std::string&gt;&amp; excludeIds,</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>                                                   <span class="keyword">const</span> std::string&amp; modelName,</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>                                                   <span class="keyword">const</span> std::string&amp; generationTimestamp,</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>                                                   <span class="keywordtype">int</span> existingCount)</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>{</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>    std::string presetContext = <a class="code hl_function" href="class_prompt_builder.html#add1bfe5a2fd49bd2b2ddef2d29a1b5de">GetPresetFlavorText</a>(customPreset);</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>    std::string presetName = customPreset.<a class="code hl_variable" href="struct_custom_preset.html#a7169ba2db551ca89884436475926e982">displayName</a>.empty() ? customPreset.<a class="code hl_variable" href="struct_custom_preset.html#aac31fc92ad757067de5661c3270ec54c">id</a> : customPreset.<a class="code hl_variable" href="struct_custom_preset.html#a7169ba2db551ca89884436475926e982">displayName</a>;</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>    std::string presetSlug = ToSlug(presetName);</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span> </div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>    std::vector&lt;std::string&gt; templateCandidates =</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>    {</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>        <span class="stringliteral">&quot;material_custom_&quot;</span> + presetSlug,</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>        <span class="stringliteral">&quot;material_&quot;</span> + presetSlug,</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>        <span class="stringliteral">&quot;material&quot;</span></div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>    };</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span> </div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>    std::string templatePrompt = TryLoadTemplateWithFallback(</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>        templateCandidates,</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>        presetContext,</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>        params,</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>        excludeIds,</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>        presetName,</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>        <span class="stringliteral">&quot;Material&quot;</span>,</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>        modelName,</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>        generationTimestamp,</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>        existingCount);</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>    <span class="keywordflow">if</span> (!templatePrompt.empty())</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>    {</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>        <span class="keywordflow">return</span> templatePrompt;</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>    }</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span> </div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>    std::string prompt;</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>    prompt += presetContext;</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>    prompt += <span class="stringliteral">&quot;Task:\n&quot;</span>;</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>    prompt += <span class="stringliteral">&quot;Generate &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#a7254056f520c27e1852d50ef8df32203">count</a>) + <span class="stringliteral">&quot; crafting materials and junk items &quot;</span>;</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>    prompt += <span class="stringliteral">&quot;for this survival setting.\n\n&quot;</span>;</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>    prompt += <span class="stringliteral">&quot;Item type:\n&quot;</span>;</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>    prompt += <span class="stringliteral">&quot;- These items are used for crafting, building, or scrapping.\n&quot;</span>;</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>    prompt += <span class="stringliteral">&quot;- Do NOT create food, drink, weapons, or medicine in this preset.\n&quot;</span>;</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>    prompt += <span class="stringliteral">&quot;- Focus on materials like wood planks, scrap metal, nails, screws, springs, electronic boards, wires, cloth, etc.\n&quot;</span>;</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>    prompt += <span class="stringliteral">&quot;Use this JSON schema EXACTLY for each item:\n&quot;</span>;</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>    prompt += <span class="stringliteral">&quot;{\n&quot;</span>;</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>    prompt += <span class="stringliteral">&quot;  \&quot;id\&quot;: string (unique, lowercase, underscore),\n&quot;</span>;</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>    prompt += <span class="stringliteral">&quot;  \&quot;displayName\&quot;: string,\n&quot;</span>;</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>    prompt += <span class="stringliteral">&quot;  \&quot;category\&quot;: \&quot;Material\&quot; | \&quot;Junk\&quot; | \&quot;Component\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>    prompt += <span class="stringliteral">&quot;  \&quot;rarity\&quot;: \&quot;Common\&quot; | \&quot;Uncommon\&quot; | \&quot;Rare\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>    prompt += <span class="stringliteral">&quot;  \&quot;maxStack\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>    prompt += <span class="stringliteral">&quot;  \&quot;materialType\&quot;: \&quot;Wood\&quot; | \&quot;Metal\&quot; | \&quot;Plastic\&quot; | \&quot;Fabric\&quot; | \&quot;Glass\&quot; | \&quot;Electronic\&quot; | \&quot;Stone\&quot; | \&quot;Rubber\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>    prompt += <span class="stringliteral">&quot;  \&quot;hardness\&quot;: integer,      // 0-100, structural strength\n&quot;</span>;</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>    prompt += <span class="stringliteral">&quot;  \&quot;flammability\&quot;: integer,  // 0-100, how well it burns\n&quot;</span>;</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>    prompt += <span class="stringliteral">&quot;  \&quot;value\&quot;: integer,         // 0-100, scrap/trade value\n&quot;</span>;</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>    prompt += <span class="stringliteral">&quot;  \&quot;description\&quot;: string\n&quot;</span>;</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>    prompt += <span class="stringliteral">&quot;}\n&quot;</span>;</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>    prompt += <span class="stringliteral">&quot;Balancing rules:\n&quot;</span>;</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>    prompt += <span class="stringliteral">&quot;- Common items: low to medium value (value 5-40), simple materials.\n&quot;</span>;</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>    prompt += <span class="stringliteral">&quot;- Uncommon items: better structural stats or higher value (value 25-70).\n&quot;</span>;</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>    prompt += <span class="stringliteral">&quot;- Rare items: high value or very useful components (value 50-100).\n&quot;</span>;</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>    prompt += <span class="stringliteral">&quot;- hardness, flammability, and value must all be in the range 0-100.\n&quot;</span>;</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>    prompt += <span class="stringliteral">&quot;- maxStack should be between 1 and 100.\n&quot;</span>;</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>    prompt += <span class="stringliteral">&quot;- description must NOT be empty and should be 1 short sentence (5-20 words)\n&quot;</span>;</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>    prompt += <span class="stringliteral">&quot;  that explains what the item looks like and how it is used.\n&quot;</span>;</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>    prompt += <span class="stringliteral">&quot;Output:\n&quot;</span>;</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>    prompt += <span class="stringliteral">&quot;- Output ONLY a JSON array of items.\n&quot;</span>;</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>    prompt += <span class="stringliteral">&quot;- No comments, no extra text, no Markdown, no explanation.\n&quot;</span>;</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>    <span class="keywordflow">return</span> prompt;</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>}</div>
</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span> </div>
<div class="foldopen" id="foldopen00686" data-start="{" data-end="}">
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno"><a class="line" href="class_prompt_builder.html#acb3d86d01fad3840d052cc9d262098a5">  686</a></span>std::string <a class="code hl_function" href="class_prompt_builder.html#acb3d86d01fad3840d052cc9d262098a5">PromptBuilder::BuildWeaponJsonPrompt</a>(<span class="keyword">const</span> <a class="code hl_struct" href="struct_food_generate_params.html">FoodGenerateParams</a>&amp; params,</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>                                                 <a class="code hl_enumeration" href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52c">PresetType</a> preset,</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>                                                 <span class="keyword">const</span> std::set&lt;std::string&gt;&amp; excludeIds,</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>                                                 <span class="keyword">const</span> std::string&amp; modelName,</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>                                                 <span class="keyword">const</span> std::string&amp; generationTimestamp,</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>                                                 <span class="keywordtype">int</span> existingCount)</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>{</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>    std::string presetContext = <a class="code hl_function" href="class_prompt_builder.html#add1bfe5a2fd49bd2b2ddef2d29a1b5de">GetPresetFlavorText</a>(preset);</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>    std::string presetName = GetPresetNameString(preset);</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>    std::string presetSlug = ToSlug(presetName);</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span> </div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>    std::vector&lt;std::string&gt; templateCandidates =</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>    {</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>        <span class="stringliteral">&quot;weapon_&quot;</span> + presetSlug,</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>        <span class="stringliteral">&quot;weapon&quot;</span></div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>    };</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span> </div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>    std::string templatePrompt = TryLoadTemplateWithFallback(</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>        templateCandidates,</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>        presetContext,</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>        params,</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>        excludeIds,</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>        presetName,</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>        <span class="stringliteral">&quot;Weapon&quot;</span>,</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>        modelName,</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>        generationTimestamp,</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>        existingCount);</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>    <span class="keywordflow">if</span> (!templatePrompt.empty())</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>    {</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>        <span class="keywordflow">return</span> templatePrompt;</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>    }</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span> </div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>    std::string prompt;</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span> </div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>    <span class="comment">// 1) Add preset world context</span></div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>    prompt += presetContext;</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span> </div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>    <span class="comment">// 2) Task description</span></div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>    prompt += <span class="stringliteral">&quot;Task:\n&quot;</span>;</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>    prompt += <span class="stringliteral">&quot;Generate &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#a7254056f520c27e1852d50ef8df32203">count</a>) + <span class="stringliteral">&quot; weapon items &quot;</span>;</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>    prompt += <span class="stringliteral">&quot;for this survival setting.\n\n&quot;</span>;</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span> </div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>    <span class="comment">// 3) Add exclusion list if provided</span></div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>    prompt += BuildExcludeSection(excludeIds);</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span> </div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>    <span class="comment">// 4) Define JSON schema</span></div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>    prompt += <span class="stringliteral">&quot;Use this JSON schema EXACTLY for each weapon:\n&quot;</span>;</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>    prompt += <span class="stringliteral">&quot;{\n&quot;</span>;</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>    prompt += <span class="stringliteral">&quot;  \&quot;id\&quot;: string (unique, lowercase, underscore),\n&quot;</span>;</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>    prompt += <span class="stringliteral">&quot;  \&quot;displayName\&quot;: string,\n&quot;</span>;</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>    prompt += <span class="stringliteral">&quot;  \&quot;category\&quot;: \&quot;Weapon\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>    prompt += <span class="stringliteral">&quot;  \&quot;rarity\&quot;: \&quot;Common\&quot; | \&quot;Uncommon\&quot; | \&quot;Rare\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>    prompt += <span class="stringliteral">&quot;  \&quot;maxStack\&quot;: integer (usually 1 for weapons),\n&quot;</span>;</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>    prompt += <span class="stringliteral">&quot;  \&quot;weaponCategory\&quot;: \&quot;Ranged\&quot; | \&quot;Melee\&quot;,  // Ranged = uses ammo, Melee = no ammo\n&quot;</span>;</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>    prompt += <span class="stringliteral">&quot;  \&quot;weaponType\&quot;: string,\n&quot;</span>;</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>    prompt += <span class="stringliteral">&quot;    // For Ranged: \&quot;AssaultRifle\&quot;, \&quot;SMG\&quot;, \&quot;Pistol\&quot;, \&quot;SniperRifle\&quot;, \&quot;Shotgun\&quot;, \&quot;LMG\&quot;, \&quot;DMR\&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>    prompt += <span class="stringliteral">&quot;    // For Melee: \&quot;Sword\&quot;, \&quot;Axe\&quot;, \&quot;Knife\&quot;, \&quot;Mace\&quot;, \&quot;Spear\&quot;, \&quot;Club\&quot;, \&quot;Hammer\&quot;, \&quot;Blade\&quot;, etc.\n&quot;</span>;</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>    prompt += <span class="stringliteral">&quot;  \&quot;caliber\&quot;: string,  // For Ranged: \&quot;9mm\&quot;, \&quot;5.56mm\&quot;, \&quot;7.62mm\&quot;, \&quot;12gauge\&quot;, etc. | For Melee: empty string\n&quot;</span>;</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>    prompt += <span class="stringliteral">&quot;  \&quot;minDamage\&quot;: integer,      // 0-100, minimum damage per hit\n&quot;</span>;</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>    prompt += <span class="stringliteral">&quot;  \&quot;maxDamage\&quot;: integer,      // 0-100, maximum damage per hit\n&quot;</span>;</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>    prompt += <span class="stringliteral">&quot;    // For Ranged: Base damage (actual = base + ammo.damageBonus)\n&quot;</span>;</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>    prompt += <span class="stringliteral">&quot;    // For Melee: Actual damage (no ammo modifier)\n&quot;</span>;</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>    prompt += <span class="stringliteral">&quot;  \&quot;fireRate\&quot;: integer,       // For Ranged: 0-1200, rounds per minute | For Melee: 0-300, attacks per minute\n&quot;</span>;</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>    prompt += <span class="stringliteral">&quot;  \&quot;accuracy\&quot;: integer,       // 0-100, base accuracy (Ranged) or hit chance (Melee)\n&quot;</span>;</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>    prompt += <span class="stringliteral">&quot;  \&quot;recoil\&quot;: integer,         // 0-100, recoil control (Ranged only, 0 for Melee)\n&quot;</span>;</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>    prompt += <span class="stringliteral">&quot;  \&quot;ergonomics\&quot;: integer,     // 0-100, handling (higher is better)\n&quot;</span>;</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>    prompt += <span class="stringliteral">&quot;  \&quot;weight\&quot;: integer,         // Weight in grams\n&quot;</span>;</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>    prompt += <span class="stringliteral">&quot;  \&quot;durability\&quot;: integer,     // 0-100, weapon condition\n&quot;</span>;</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>    prompt += <span class="stringliteral">&quot;  // Ranged weapon stats (set to 0 for Melee)\n&quot;</span>;</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>    prompt += <span class="stringliteral">&quot;  \&quot;muzzleVelocity\&quot;: integer, // Muzzle velocity in m/s (Ranged only, typical: 300-1000)\n&quot;</span>;</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>    prompt += <span class="stringliteral">&quot;  \&quot;effectiveRange\&quot;: integer, // Effective range in meters (Ranged only, typical: 50-800)\n&quot;</span>;</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>    prompt += <span class="stringliteral">&quot;  \&quot;penetrationPower\&quot;: integer, // 0-100, armor penetration capability (Ranged only)\n&quot;</span>;</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>    prompt += <span class="stringliteral">&quot;  // Melee weapon stats (set to 0 for Ranged)\n&quot;</span>;</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>    prompt += <span class="stringliteral">&quot;  \&quot;attackSpeed\&quot;: integer,    // Attacks per second (Melee only, typical: 1-5)\n&quot;</span>;</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>    prompt += <span class="stringliteral">&quot;  \&quot;reach\&quot;: integer,           // Reach in meters (Melee only, typical: 0.5-3.0, store as cm: 50-300)\n&quot;</span>;</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>    prompt += <span class="stringliteral">&quot;  \&quot;staminaCost\&quot;: integer,    // Stamina cost per attack (Melee only, 0-100)\n&quot;</span>;</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>    prompt += <span class="stringliteral">&quot;  \&quot;moddingSlots\&quot;: integer,   // Number of available modding slots (typical: 3-8)\n&quot;</span>;</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>    prompt += <span class="stringliteral">&quot;  \&quot;attachmentSlots\&quot;: [\n&quot;</span>;</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>    prompt += <span class="stringliteral">&quot;    {\n&quot;</span>;</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>    prompt += <span class="stringliteral">&quot;      \&quot;slotType\&quot;: string,    // \&quot;Muzzle\&quot;, \&quot;Grip\&quot;, \&quot;Sight\&quot;, \&quot;Scope\&quot;, \&quot;Stock\&quot;, \&quot;Barrel\&quot;, \&quot;Handguard\&quot;, \&quot;Rail\&quot;, \&quot;Magazine\&quot;, \&quot;GasBlock\&quot;, \&quot;ChargingHandle\&quot;, \&quot;PistolGrip\&quot;, \&quot;Foregrip\&quot;, etc.\n&quot;</span>;</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>    prompt += <span class="stringliteral">&quot;      \&quot;slotIndex\&quot;: integer,   // For multiple slots of same type (default 0)\n&quot;</span>;</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>    prompt += <span class="stringliteral">&quot;      \&quot;isRequired\&quot;: boolean  // Whether this slot must be filled (default false)\n&quot;</span>;</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>    prompt += <span class="stringliteral">&quot;    }\n&quot;</span>;</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>    prompt += <span class="stringliteral">&quot;  ],\n&quot;</span>;</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>    prompt += <span class="stringliteral">&quot;  NOTE: Magazine is now a separate WeaponComponent. Do NOT include magazineCapacity or magazineType in weapon data.\n&quot;</span>;</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>    prompt += <span class="stringliteral">&quot;  \&quot;description\&quot;: string\n&quot;</span>;</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>    prompt += <span class="stringliteral">&quot;}\n&quot;</span>;</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>    prompt += <span class="stringliteral">&quot;IMPORTANT:\n&quot;</span>;</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>    prompt += <span class="stringliteral">&quot;- category MUST be \&quot;Weapon\&quot;.\n&quot;</span>;</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>    prompt += <span class="stringliteral">&quot;- weaponCategory MUST be either \&quot;Ranged\&quot; or \&quot;Melee\&quot;.\n&quot;</span>;</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>    prompt += <span class="stringliteral">&quot;- description must NOT be empty and should be 1 short sentence (5-20 words)\n&quot;</span>;</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>    prompt += <span class="stringliteral">&quot;  that describes the weapon&#39;s appearance and characteristics.\n&quot;</span>;</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>    prompt += <span class="stringliteral">&quot;Ranged Weapons:\n&quot;</span>;</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>    prompt += <span class="stringliteral">&quot;- Use ammo (caliber must match ammo caliber).\n&quot;</span>;</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>    prompt += <span class="stringliteral">&quot;- Damage is base damage + ammo.damageBonus (base damage should be low, 5-20).\n&quot;</span>;</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>    prompt += <span class="stringliteral">&quot;- Must have caliber, muzzleVelocity, effectiveRange, penetrationPower.\n&quot;</span>;</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>    prompt += <span class="stringliteral">&quot;- attachmentSlots should include: Muzzle, Grip, Sight, Scope, Stock, Barrel, Handguard, Rail, Magazine, GasBlock, ChargingHandle, PistolGrip, Foregrip, etc.\n&quot;</span>;</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>    prompt += <span class="stringliteral">&quot;- Magazine slot is REQUIRED (type: \&quot;Magazine\&quot;).\n&quot;</span>;</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>    prompt += <span class="stringliteral">&quot;- Tarkov-style detail: Include realistic slots like GasBlock, ChargingHandle, PistolGrip for assault rifles.\n&quot;</span>;</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>    prompt += <span class="stringliteral">&quot;Melee Weapons:\n&quot;</span>;</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>    prompt += <span class="stringliteral">&quot;- Do NOT use ammo (caliber should be empty string).\n&quot;</span>;</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>    prompt += <span class="stringliteral">&quot;- Damage is actual damage (no ammo modifier, typical: 30-80).\n&quot;</span>;</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>    prompt += <span class="stringliteral">&quot;- Must have attackSpeed, reach, staminaCost.\n&quot;</span>;</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>    prompt += <span class="stringliteral">&quot;- Set muzzleVelocity, effectiveRange, penetrationPower, recoil to 0.\n&quot;</span>;</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>    prompt += <span class="stringliteral">&quot;- attachmentSlots are optional (e.g., Grip, Pommel for swords).\n&quot;</span>;</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>    prompt += <span class="stringliteral">&quot;- Magazine slot should NOT be included.\n&quot;</span>;</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>    prompt += <span class="stringliteral">&quot;Balancing:\n&quot;</span>;</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>    prompt += <span class="stringliteral">&quot;- Common weapons: lower damage, basic stats, simple design, fewer modding slots (3-4).\n&quot;</span>;</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>    prompt += <span class="stringliteral">&quot;- Uncommon weapons: medium damage, better stats, more attachment slots, moderate modding slots (5-6).\n&quot;</span>;</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>    prompt += <span class="stringliteral">&quot;- Rare weapons: high damage, excellent stats, many attachment slots, high modding slots (7-8).\n&quot;</span>;</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>    prompt += <span class="stringliteral">&quot;Ranged Weapon Examples:\n&quot;</span>;</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>    prompt += <span class="stringliteral">&quot;- Assault rifles: fireRate 600-900, base damage 5-15, muzzleVelocity 700-900 m/s, effectiveRange 300-500m.\n&quot;</span>;</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>    prompt += <span class="stringliteral">&quot;- SMGs: fireRate 700-1000, base damage 3-10, muzzleVelocity 300-500 m/s, effectiveRange 100-200m.\n&quot;</span>;</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>    prompt += <span class="stringliteral">&quot;- Pistols: fireRate 400-600, base damage 2-8, muzzleVelocity 300-450 m/s, effectiveRange 50-100m.\n&quot;</span>;</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>    prompt += <span class="stringliteral">&quot;- Sniper rifles: fireRate 20-60, base damage 10-20, muzzleVelocity 800-1000 m/s, effectiveRange 600-800m.\n&quot;</span>;</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>    prompt += <span class="stringliteral">&quot;- Shotguns: fireRate 60-120, base damage 8-15, muzzleVelocity 300-400 m/s, effectiveRange 30-50m.\n&quot;</span>;</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>    prompt += <span class="stringliteral">&quot;- DMRs: fireRate 200-400, base damage 8-15, muzzleVelocity 700-900 m/s, effectiveRange 400-600m.\n&quot;</span>;</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>    prompt += <span class="stringliteral">&quot;Melee Weapon Examples:\n&quot;</span>;</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>    prompt += <span class="stringliteral">&quot;- Swords: damage 40-60, attackSpeed 2-4, reach 100-150cm, staminaCost 10-20, moderate weight.\n&quot;</span>;</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>    prompt += <span class="stringliteral">&quot;- Axes: damage 50-70, attackSpeed 1-2, reach 80-120cm, staminaCost 20-30, heavy weight.\n&quot;</span>;</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>    prompt += <span class="stringliteral">&quot;- Knives: damage 20-35, attackSpeed 3-5, reach 30-50cm, staminaCost 5-10, light weight.\n&quot;</span>;</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>    prompt += <span class="stringliteral">&quot;- Spears: damage 45-65, attackSpeed 2-3, reach 150-250cm, staminaCost 15-25, moderate weight.\n&quot;</span>;</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>    prompt += <span class="stringliteral">&quot;- Clubs/Maces: damage 55-75, attackSpeed 1-2, reach 70-100cm, staminaCost 25-35, heavy weight.\n&quot;</span>;</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>    prompt += <span class="stringliteral">&quot;- All stat values must be within their specified ranges.\n&quot;</span>;</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>    prompt += <span class="stringliteral">&quot;Output:\n&quot;</span>;</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>    prompt += <span class="stringliteral">&quot;- Output ONLY a JSON array of weapons.\n&quot;</span>;</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>    prompt += <span class="stringliteral">&quot;- No comments, no extra text, no Markdown, no explanation.\n&quot;</span>;</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span> </div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>    <span class="keywordflow">return</span> prompt;</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>}</div>
</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span> </div>
<div class="foldopen" id="foldopen00836" data-start="{" data-end="}">
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno"><a class="line" href="class_prompt_builder.html#a5c0d0a723489fe4e135a7eab31e0d565">  836</a></span>std::string <a class="code hl_function" href="class_prompt_builder.html#acb3d86d01fad3840d052cc9d262098a5">PromptBuilder::BuildWeaponJsonPrompt</a>(<span class="keyword">const</span> <a class="code hl_struct" href="struct_food_generate_params.html">FoodGenerateParams</a>&amp; params,</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>                                                 <span class="keyword">const</span> <a class="code hl_struct" href="struct_custom_preset.html">CustomPreset</a>&amp; customPreset,</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>                                                 <span class="keyword">const</span> std::set&lt;std::string&gt;&amp; excludeIds,</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>                                                 <span class="keyword">const</span> std::string&amp; modelName,</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>                                                 <span class="keyword">const</span> std::string&amp; generationTimestamp,</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>                                                 <span class="keywordtype">int</span> existingCount)</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>{</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>    std::string presetContext = <a class="code hl_function" href="class_prompt_builder.html#add1bfe5a2fd49bd2b2ddef2d29a1b5de">GetPresetFlavorText</a>(customPreset);</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>    std::string presetName = customPreset.<a class="code hl_variable" href="struct_custom_preset.html#a7169ba2db551ca89884436475926e982">displayName</a>.empty() ? customPreset.<a class="code hl_variable" href="struct_custom_preset.html#aac31fc92ad757067de5661c3270ec54c">id</a> : customPreset.<a class="code hl_variable" href="struct_custom_preset.html#a7169ba2db551ca89884436475926e982">displayName</a>;</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>    std::string presetSlug = ToSlug(presetName);</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span> </div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>    std::vector&lt;std::string&gt; templateCandidates =</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>    {</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>        <span class="stringliteral">&quot;weapon_custom_&quot;</span> + presetSlug,</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>        <span class="stringliteral">&quot;weapon_&quot;</span> + presetSlug,</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>        <span class="stringliteral">&quot;weapon&quot;</span></div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>    };</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span> </div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>    std::string templatePrompt = TryLoadTemplateWithFallback(</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>        templateCandidates,</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>        presetContext,</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>        params,</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>        excludeIds,</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>        presetName,</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>        <span class="stringliteral">&quot;Weapon&quot;</span>,</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>        modelName,</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>        generationTimestamp,</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>        existingCount);</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>    <span class="keywordflow">if</span> (!templatePrompt.empty())</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>    {</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>        <span class="keywordflow">return</span> templatePrompt;</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>    }</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span> </div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>    std::string prompt;</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>    prompt += presetContext;</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>    prompt += <span class="stringliteral">&quot;Task:\n&quot;</span>;</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>    prompt += <span class="stringliteral">&quot;Generate &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#a7254056f520c27e1852d50ef8df32203">count</a>) + <span class="stringliteral">&quot; weapons &quot;</span>;</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>    prompt += <span class="stringliteral">&quot;for this survival setting.\n&quot;</span>;</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>    prompt += BuildExcludeSection(excludeIds);</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>    prompt += <span class="stringliteral">&quot;Use this JSON schema EXACTLY for each weapon:\n&quot;</span>;</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>    prompt += <span class="stringliteral">&quot;{\n&quot;</span>;</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>    prompt += <span class="stringliteral">&quot;  \&quot;id\&quot;: string (unique, lowercase, underscore),\n&quot;</span>;</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>    prompt += <span class="stringliteral">&quot;  \&quot;displayName\&quot;: string,\n&quot;</span>;</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>    prompt += <span class="stringliteral">&quot;  \&quot;category\&quot;: \&quot;Weapon\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>    prompt += <span class="stringliteral">&quot;  \&quot;rarity\&quot;: \&quot;Common\&quot; | \&quot;Uncommon\&quot; | \&quot;Rare\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>    prompt += <span class="stringliteral">&quot;  \&quot;maxStack\&quot;: integer (usually 1),\n&quot;</span>;</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>    prompt += <span class="stringliteral">&quot;  \&quot;weaponCategory\&quot;: \&quot;Ranged\&quot; | \&quot;Melee\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>    prompt += <span class="stringliteral">&quot;  \&quot;weaponType\&quot;: string,\n&quot;</span>;</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>    prompt += <span class="stringliteral">&quot;  \&quot;caliber\&quot;: string (empty for Melee),\n&quot;</span>;</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>    prompt += <span class="stringliteral">&quot;  \&quot;minDamage\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>    prompt += <span class="stringliteral">&quot;  \&quot;maxDamage\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>    prompt += <span class="stringliteral">&quot;  \&quot;fireRate\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>    prompt += <span class="stringliteral">&quot;  \&quot;accuracy\&quot;: integer (0-100),\n&quot;</span>;</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>    prompt += <span class="stringliteral">&quot;  \&quot;recoil\&quot;: integer (0-100, lower is better, Ranged only),\n&quot;</span>;</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>    prompt += <span class="stringliteral">&quot;  \&quot;ergonomics\&quot;: integer (0-100, higher is better),\n&quot;</span>;</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>    prompt += <span class="stringliteral">&quot;  \&quot;weight\&quot;: integer (grams),\n&quot;</span>;</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>    prompt += <span class="stringliteral">&quot;  \&quot;durability\&quot;: integer (0-100),\n&quot;</span>;</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>    prompt += <span class="stringliteral">&quot;  \&quot;muzzleVelocity\&quot;: integer (m/s, Ranged only, 0 for Melee),\n&quot;</span>;</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>    prompt += <span class="stringliteral">&quot;  \&quot;effectiveRange\&quot;: integer (meters, Ranged only, 0 for Melee),\n&quot;</span>;</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>    prompt += <span class="stringliteral">&quot;  \&quot;penetrationPower\&quot;: integer (0-100, Ranged only),\n&quot;</span>;</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>    prompt += <span class="stringliteral">&quot;  \&quot;attackSpeed\&quot;: integer (attacks per second, Melee only, 0 for Ranged),\n&quot;</span>;</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>    prompt += <span class="stringliteral">&quot;  \&quot;reach\&quot;: integer (meters, Melee only, 0 for Ranged),\n&quot;</span>;</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>    prompt += <span class="stringliteral">&quot;  \&quot;staminaCost\&quot;: integer (0-100, Melee only),\n&quot;</span>;</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>    prompt += <span class="stringliteral">&quot;  \&quot;moddingSlots\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>    prompt += <span class="stringliteral">&quot;  \&quot;attachmentSlots\&quot;: [\n&quot;</span>;</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>    prompt += <span class="stringliteral">&quot;    { \&quot;slotType\&quot;: string, \&quot;slotIndex\&quot;: integer, \&quot;hasBuiltInRail\&quot;: boolean }\n&quot;</span>;</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>    prompt += <span class="stringliteral">&quot;  ],\n&quot;</span>;</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>    prompt += <span class="stringliteral">&quot;  \&quot;description\&quot;: string\n&quot;</span>;</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>    prompt += <span class="stringliteral">&quot;}\n&quot;</span>;</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>    prompt += <span class="stringliteral">&quot;Balancing rules:\n&quot;</span>;</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>    prompt += <span class="stringliteral">&quot;- Ranged weapons: base damage (actual = base + ammo.damageBonus), must have caliber.\n&quot;</span>;</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>    prompt += <span class="stringliteral">&quot;- Melee weapons: actual damage (no ammo modifier), no caliber, no ranged stats.\n&quot;</span>;</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>    prompt += <span class="stringliteral">&quot;- Common: damage 5-15 (Ranged) or 10-20 (Melee), basic stats.\n&quot;</span>;</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>    prompt += <span class="stringliteral">&quot;- Uncommon: damage 10-25 (Ranged) or 15-30 (Melee), better stats.\n&quot;</span>;</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>    prompt += <span class="stringliteral">&quot;- Rare: damage 15-35 (Ranged) or 20-40 (Melee), excellent stats.\n&quot;</span>;</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>    prompt += <span class="stringliteral">&quot;- All stat values must be within their specified ranges.\n&quot;</span>;</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>    prompt += <span class="stringliteral">&quot;Output:\n&quot;</span>;</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>    prompt += <span class="stringliteral">&quot;- Output ONLY a JSON array of weapons.\n&quot;</span>;</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>    prompt += <span class="stringliteral">&quot;- No comments, no extra text, no Markdown, no explanation.\n&quot;</span>;</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>    <span class="keywordflow">return</span> prompt;</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>}</div>
</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span> </div>
<div class="foldopen" id="foldopen00927" data-start="{" data-end="}">
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno"><a class="line" href="class_prompt_builder.html#a68ca15c2b188625ac36693e471ceb20c">  927</a></span>std::string <a class="code hl_function" href="class_prompt_builder.html#a68ca15c2b188625ac36693e471ceb20c">PromptBuilder::BuildWeaponComponentJsonPrompt</a>(<span class="keyword">const</span> <a class="code hl_struct" href="struct_food_generate_params.html">FoodGenerateParams</a>&amp; params,</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>                                                          <a class="code hl_enumeration" href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52c">PresetType</a> preset,</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>                                                          <span class="keyword">const</span> std::set&lt;std::string&gt;&amp; excludeIds,</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>                                                          <span class="keyword">const</span> std::string&amp; modelName,</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>                                                          <span class="keyword">const</span> std::string&amp; generationTimestamp,</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>                                                          <span class="keywordtype">int</span> existingCount)</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>{</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>    std::string presetContext = <a class="code hl_function" href="class_prompt_builder.html#add1bfe5a2fd49bd2b2ddef2d29a1b5de">GetPresetFlavorText</a>(preset);</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>    std::string presetName = GetPresetNameString(preset);</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>    std::string presetSlug = ToSlug(presetName);</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span> </div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>    std::vector&lt;std::string&gt; templateCandidates =</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>    {</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>        <span class="stringliteral">&quot;weapon_component_&quot;</span> + presetSlug,</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>        <span class="stringliteral">&quot;weapon_component&quot;</span></div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>    };</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span> </div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>    std::string templatePrompt = TryLoadTemplateWithFallback(</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>        templateCandidates,</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>        presetContext,</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>        params,</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>        excludeIds,</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>        presetName,</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>        <span class="stringliteral">&quot;WeaponComponent&quot;</span>,</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>        modelName,</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>        generationTimestamp,</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>        existingCount);</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>    <span class="keywordflow">if</span> (!templatePrompt.empty())</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>    {</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>        <span class="keywordflow">return</span> templatePrompt;</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>    }</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span> </div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>    std::string prompt;</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span> </div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>    <span class="comment">// 1) Add preset world context</span></div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>    prompt += presetContext;</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span> </div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>    <span class="comment">// 2) Task description</span></div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>    prompt += <span class="stringliteral">&quot;Task:\n&quot;</span>;</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>    prompt += <span class="stringliteral">&quot;Generate &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#a7254056f520c27e1852d50ef8df32203">count</a>) + <span class="stringliteral">&quot; weapon attachment components &quot;</span>;</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>    prompt += <span class="stringliteral">&quot;for this survival setting.\n\n&quot;</span>;</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span> </div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>    <span class="comment">// 3) Add exclusion list if provided</span></div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>    prompt += BuildExcludeSection(excludeIds);</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span> </div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>    <span class="comment">// 4) Define JSON schema</span></div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>    prompt += <span class="stringliteral">&quot;Use this JSON schema EXACTLY for each component:\n&quot;</span>;</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>    prompt += <span class="stringliteral">&quot;{\n&quot;</span>;</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>    prompt += <span class="stringliteral">&quot;  \&quot;id\&quot;: string (unique, lowercase, underscore),\n&quot;</span>;</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>    prompt += <span class="stringliteral">&quot;  \&quot;displayName\&quot;: string,\n&quot;</span>;</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>    prompt += <span class="stringliteral">&quot;  \&quot;category\&quot;: \&quot;WeaponComponent\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>    prompt += <span class="stringliteral">&quot;  \&quot;rarity\&quot;: \&quot;Common\&quot; | \&quot;Uncommon\&quot; | \&quot;Rare\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>    prompt += <span class="stringliteral">&quot;  \&quot;maxStack\&quot;: integer (usually 1 for components),\n&quot;</span>;</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>    prompt += <span class="stringliteral">&quot;  \&quot;componentType\&quot;: \&quot;Muzzle\&quot; | \&quot;Grip\&quot; | \&quot;Sight\&quot; | \&quot;Scope\&quot; | \&quot;Stock\&quot; | \&quot;Barrel\&quot; | \&quot;Handguard\&quot; | \&quot;Rail\&quot; | \&quot;Flashlight\&quot; | \&quot;Laser\&quot; | \&quot;Magazine\&quot; | \&quot;GasBlock\&quot; | \&quot;ChargingHandle\&quot; | \&quot;PistolGrip\&quot; | \&quot;Foregrip\&quot; | \&quot;Bipod\&quot; | \&quot;TacticalDevice\&quot; | \&quot;Mount\&quot; | \&quot;Adapter\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>    prompt += <span class="stringliteral">&quot;  // For Magazine components ONLY:\n&quot;</span>;</div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>    prompt += <span class="stringliteral">&quot;  \&quot;magazineCapacity\&quot;: integer,    // Capacity in rounds (ONLY for Magazine type, typical: 10-100)\n&quot;</span>;</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>    prompt += <span class="stringliteral">&quot;  \&quot;caliber\&quot;: string,              // Compatible caliber (ONLY for Magazine type, e.g., \&quot;9mm\&quot;, \&quot;5.56mm\&quot;)\n&quot;</span>;</div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>    prompt += <span class="stringliteral">&quot;  \&quot;magazineType\&quot;: string,         // \&quot;Standard\&quot;, \&quot;Extended\&quot;, \&quot;Drum\&quot;, \&quot;QuadStack\&quot; (ONLY for Magazine type)\n&quot;</span>;</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>    prompt += <span class="stringliteral">&quot;  \&quot;loadedRounds\&quot;: [               // OPTIONAL preview of actual load order (top to bottom)\n&quot;</span>;</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>    prompt += <span class="stringliteral">&quot;    {\n&quot;</span>;</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>    prompt += <span class="stringliteral">&quot;      \&quot;orderIndex\&quot;: integer,      // 0 = first rounds to fire, increasing deeper into mag\n&quot;</span>;</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>    prompt += <span class="stringliteral">&quot;      \&quot;roundCount\&quot;: integer,      // How many consecutive rounds use this ammo type (1- magazineCapacity)\n&quot;</span>;</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>    prompt += <span class="stringliteral">&quot;      \&quot;ammoId\&quot;: string,           // Reference ammo ID (must exist in Ammo dataset)\n&quot;</span>;</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>    prompt += <span class="stringliteral">&quot;      \&quot;ammoDisplayName\&quot;: string,  // Friendly name (e.g., \&quot;7.62x39 AP\&quot;)\n&quot;</span>;</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>    prompt += <span class="stringliteral">&quot;      \&quot;ammoNotes\&quot;: string         // Short descriptor (\&quot;AP\&quot;, \&quot;FMJ\&quot;, \&quot;Tracer\&quot;)\n&quot;</span>;</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>    prompt += <span class="stringliteral">&quot;    }\n&quot;</span>;</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>    prompt += <span class="stringliteral">&quot;  ],\n&quot;</span>;</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>    prompt += <span class="stringliteral">&quot;  \&quot;compatibleSlots\&quot;: [string],  // Which weapon slots this can attach to, e.g., [\&quot;Muzzle\&quot;, \&quot;Barrel\&quot;] or [\&quot;Magazine\&quot;]\n&quot;</span>;</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>    prompt += <span class="stringliteral">&quot;  \&quot;subSlots\&quot;: [\n&quot;</span>;</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>    prompt += <span class="stringliteral">&quot;    {\n&quot;</span>;</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>    prompt += <span class="stringliteral">&quot;      \&quot;slotType\&quot;: string,        // \&quot;Muzzle\&quot;, \&quot;Grip\&quot;, \&quot;Sight\&quot;, \&quot;Rail\&quot;, etc.\n&quot;</span>;</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>    prompt += <span class="stringliteral">&quot;      \&quot;slotIndex\&quot;: integer,       // For multiple slots of same type (default 0)\n&quot;</span>;</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>    prompt += <span class="stringliteral">&quot;      \&quot;hasBuiltInRail\&quot;: boolean   // If true, this slot already has a rail (default false)\n&quot;</span>;</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>    prompt += <span class="stringliteral">&quot;    }\n&quot;</span>;</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>    prompt += <span class="stringliteral">&quot;  ],\n&quot;</span>;</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>    prompt += <span class="stringliteral">&quot;  \&quot;damageModifier\&quot;: integer,      // Damage bonus/penalty (can be negative, range -50 to 50)\n&quot;</span>;</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>    prompt += <span class="stringliteral">&quot;  \&quot;recoilModifier\&quot;: integer,     // Recoil reduction (positive = less recoil, can be negative, range -50 to 50)\n&quot;</span>;</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>    prompt += <span class="stringliteral">&quot;  \&quot;ergonomicsModifier\&quot;: integer, // Ergonomics bonus/penalty (can be negative, range -50 to 50)\n&quot;</span>;</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>    prompt += <span class="stringliteral">&quot;  \&quot;accuracyModifier\&quot;: integer,   // Accuracy bonus/penalty (can be negative, range -50 to 50)\n&quot;</span>;</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>    prompt += <span class="stringliteral">&quot;  \&quot;weightModifier\&quot;: integer,     // Weight change in grams (can be negative, range -2000 to 2000)\n&quot;</span>;</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>    prompt += <span class="stringliteral">&quot;  \&quot;muzzleVelocityModifier\&quot;: integer, // Muzzle velocity modifier in m/s (can be negative, range -200 to 200)\n&quot;</span>;</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>    prompt += <span class="stringliteral">&quot;  \&quot;effectiveRangeModifier\&quot;: integer, // Effective range modifier in meters (can be negative, range -200 to 200)\n&quot;</span>;</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>    prompt += <span class="stringliteral">&quot;  \&quot;penetrationModifier\&quot;: integer,     // Penetration power modifier (can be negative, range -50 to 50)\n&quot;</span>;</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>    prompt += <span class="stringliteral">&quot;  \&quot;hasBuiltInRail\&quot;: boolean,      // If true, this component has an integrated rail\n&quot;</span>;</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>    prompt += <span class="stringliteral">&quot;  \&quot;railType\&quot;: string,            // \&quot;Picatinny\&quot;, \&quot;M-LOK\&quot;, \&quot;KeyMod\&quot;, etc. (if hasBuiltInRail is true)\n&quot;</span>;</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>    prompt += <span class="stringliteral">&quot;  \&quot;description\&quot;: string\n&quot;</span>;</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>    prompt += <span class="stringliteral">&quot;}\n&quot;</span>;</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>    prompt += <span class="stringliteral">&quot;IMPORTANT:\n&quot;</span>;</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>    prompt += <span class="stringliteral">&quot;- category MUST be \&quot;WeaponComponent\&quot;.\n&quot;</span>;</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>    prompt += <span class="stringliteral">&quot;- description must NOT be empty and should be 1 short sentence (5-20 words)\n&quot;</span>;</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>    prompt += <span class="stringliteral">&quot;  that describes the component&#39;s appearance and function.\n&quot;</span>;</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>    prompt += <span class="stringliteral">&quot;- compatibleSlots must match the componentType (e.g., Muzzle components attach to Muzzle slots).\n&quot;</span>;</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>    prompt += <span class="stringliteral">&quot;- Some components can have subSlots:\n&quot;</span>;</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>    prompt += <span class="stringliteral">&quot;  * Handguard can have Rail subSlots (with or without built-in rail).\n&quot;</span>;</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>    prompt += <span class="stringliteral">&quot;  * Barrel can have Muzzle subSlot.\n&quot;</span>;</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>    prompt += <span class="stringliteral">&quot;  * Rail components can have Grip, Flashlight, Laser subSlots.\n&quot;</span>;</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>    prompt += <span class="stringliteral">&quot;  * Handguard with built-in rail (hasBuiltInRail=true) can directly have Grip/Flashlight/Laser subSlots.\n&quot;</span>;</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>    prompt += <span class="stringliteral">&quot;- Stat modifiers should be realistic (e.g., suppressors reduce recoil but add weight).\n&quot;</span>;</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>    prompt += <span class="stringliteral">&quot;- Magazines can show actual loaded order:\n&quot;</span>;</div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>    prompt += <span class="stringliteral">&quot;  * orderIndex 0 = first rounds to fire (top of magazine).\n&quot;</span>;</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>    prompt += <span class="stringliteral">&quot;  * Sum of all roundCount values must be &lt;= magazineCapacity.\n&quot;</span>;</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>    prompt += <span class="stringliteral">&quot;  * Mixing ammo types is allowed by default; include as many segments as needed.\n&quot;</span>;</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>    prompt += <span class="stringliteral">&quot;  * ammoId MUST reference an Ammo item ID (e.g., \&quot;Ammo_556_AP\&quot;).\n&quot;</span>;</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>    prompt += <span class="stringliteral">&quot;  * Use ammoNotes like \&quot;AP\&quot;, \&quot;FMJ\&quot;, \&quot;Tracer\&quot; to describe the segment.\n&quot;</span>;</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>    prompt += <span class="stringliteral">&quot;Component Examples (Tarkov-style):\n&quot;</span>;</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>    prompt += <span class="stringliteral">&quot;- Magazine: Standard 30-round, Extended 60-round, Drum 100-round (attach to Magazine slot, compatibleSlots: [\&quot;Magazine\&quot;], includes magazineCapacity, caliber, magazineType, plus detailed loadedRounds for AP/FMJ mixes).\n&quot;</span>;</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>    prompt += <span class="stringliteral">&quot;- Muzzle: Suppressor, Compensator, Flash Hider, Muzzle Brake (attach to Muzzle slot, reduce recoil but add weight, may reduce muzzle velocity).\n&quot;</span>;</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>    prompt += <span class="stringliteral">&quot;- Grip: Vertical Grip, Angled Grip, Bipod (attach to Rail or Handguard with rail, improve ergonomics and recoil).\n&quot;</span>;</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>    prompt += <span class="stringliteral">&quot;- Sight: Red Dot, Holographic, Iron Sights (attach to Rail, improve accuracy, minimal weight).\n&quot;</span>;</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>    prompt += <span class="stringliteral">&quot;- Scope: 4x Scope, 8x Scope, Variable Zoom (attach to Rail, improve accuracy and effective range, may reduce ergonomics).\n&quot;</span>;</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>    prompt += <span class="stringliteral">&quot;- Stock: Fixed Stock, Folding Stock, Collapsible Stock (attach to Stock slot, improve recoil/ergonomics, weight varies).\n&quot;</span>;</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>    prompt += <span class="stringliteral">&quot;- Barrel: Long Barrel, Short Barrel, Heavy Barrel (attach to Barrel slot, may have Muzzle subSlot, affects muzzle velocity and effective range).\n&quot;</span>;</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>    prompt += <span class="stringliteral">&quot;- Handguard: Standard Handguard, Extended Handguard, KeyMod Handguard (attach to Handguard slot, may have Rail subSlots or built-in rail, affects ergonomics).\n&quot;</span>;</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>    prompt += <span class="stringliteral">&quot;- Rail: Picatinny Rail, M-LOK Rail, KeyMod Rail (attach to Rail slot or Handguard subSlot, can have Grip/Flashlight/Laser subSlots).\n&quot;</span>;</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>    prompt += <span class="stringliteral">&quot;- GasBlock: Standard Gas Block, Low Profile Gas Block (attach to GasBlock slot, affects reliability).\n&quot;</span>;</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>    prompt += <span class="stringliteral">&quot;- ChargingHandle: Standard, Extended, Ambidextrous (attach to ChargingHandle slot, affects ergonomics).\n&quot;</span>;</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>    prompt += <span class="stringliteral">&quot;- PistolGrip: Standard Grip, Ergonomic Grip, Rubberized Grip (attach to PistolGrip slot, affects ergonomics).\n&quot;</span>;</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>    prompt += <span class="stringliteral">&quot;- Foregrip: Vertical Foregrip, Angled Foregrip (attach to Rail or Handguard, improves recoil and ergonomics).\n&quot;</span>;</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>    prompt += <span class="stringliteral">&quot;- Flashlight: Tactical Flashlight, Weapon Light (attach to Rail, no stat modifiers, tactical use).\n&quot;</span>;</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>    prompt += <span class="stringliteral">&quot;- Laser: Red Laser, IR Laser, Laser/Flashlight Combo (attach to Rail, improve accuracy, may have flashlight built-in).\n&quot;</span>;</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>    prompt += <span class="stringliteral">&quot;- Mount: Scope Mount, Sight Mount (attach to Rail, allows mounting scopes/sights, may have subSlots).\n&quot;</span>;</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>    prompt += <span class="stringliteral">&quot;- Adapter: Thread Adapter, Rail Adapter (attach to various slots, allows compatibility between different systems).\n&quot;</span>;</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>    prompt += <span class="stringliteral">&quot;Balancing:\n&quot;</span>;</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>    prompt += <span class="stringliteral">&quot;- Common components: small stat bonuses (0-5), basic design.\n&quot;</span>;</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>    prompt += <span class="stringliteral">&quot;- Uncommon components: medium stat bonuses (5-15), better design.\n&quot;</span>;</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>    prompt += <span class="stringliteral">&quot;- Rare components: large stat bonuses (10-25), advanced design, may have multiple subSlots.\n&quot;</span>;</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>    prompt += <span class="stringliteral">&quot;- Modifiers can be negative (e.g., heavy components reduce ergonomics).\n&quot;</span>;</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>    prompt += <span class="stringliteral">&quot;Realism rules:\n&quot;</span>;</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>    prompt += <span class="stringliteral">&quot;- Reference real manufacturers/models whenever possible (e.g., EOTech EXPS3 sight, Aimpoint PRO, Trijicon ACOG, Vortex Razor, Magpul MOE SL stock, BCM Gunfighter charging handle, SureFire Scout light, Dead Air Sandman suppressor, Lancer L5 magazine).\n&quot;</span>;</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>    prompt += <span class="stringliteral">&quot;- Keep effects grounded in physics:\n&quot;</span>;</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>    prompt += <span class="stringliteral">&quot;  * Scopes/Sights improve accuracy/effective range, add weight, and NEVER change damage or recoil.\n&quot;</span>;</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>    prompt += <span class="stringliteral">&quot;  * Muzzle devices reduce recoil or flash; suppressors add noticeable weight and may slightly lower muzzle velocity.\n&quot;</span>;</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>    prompt += <span class="stringliteral">&quot;  * Grips/Foregrips/Pistol Grips improve ergonomics and recoil control but cannot increase damage.\n&quot;</span>;</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>    prompt += <span class="stringliteral">&quot;  * Stocks stabilize recoil and ergonomics; folding stocks can slightly improve ergonomics but rarely boost accuracy beyond 10.\n&quot;</span>;</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>    prompt += <span class="stringliteral">&quot;  * Barrels affect muzzle velocity, effective range, and weight in realistic directions (long/heavy barrels add weight and velocity, short barrels do the opposite).\n&quot;</span>;</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>    prompt += <span class="stringliteral">&quot;  * Handguards/Rails mainly provide mounting points, with small ergonomics/weight changes only.\n&quot;</span>;</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>    prompt += <span class="stringliteral">&quot;  * Flashlights/Lasers/Tactical devices add weight and provide minimal stat bonuses (laser can add small accuracy, flashlight typically adds none).\n&quot;</span>;</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>    prompt += <span class="stringliteral">&quot;  * Magazines only affect ergonomics/weight/reliability, never raw damage or penetration.\n&quot;</span>;</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>    prompt += <span class="stringliteral">&quot;  * Charging handles, mounts, adapters, and gas blocks offer subtle ergonomics or reliability tweaks, not huge stat swings.\n&quot;</span>;</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>    prompt += <span class="stringliteral">&quot;- Describe components like a loadout guide: include model name + manufacturer tone (\&quot;Magpul MOE SL-K stock\&quot;), material cues, and finish.\n&quot;</span>;</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>    prompt += <span class="stringliteral">&quot;Output:\n&quot;</span>;</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>    prompt += <span class="stringliteral">&quot;- Output ONLY a JSON array of components.\n&quot;</span>;</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>    prompt += <span class="stringliteral">&quot;- No comments, no extra text, no Markdown, no explanation.\n&quot;</span>;</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span> </div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>    <span class="keywordflow">return</span> prompt;</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>}</div>
</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span> </div>
<div class="foldopen" id="foldopen01086" data-start="{" data-end="}">
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"><a class="line" href="class_prompt_builder.html#a1a7f98037c3eb1016f26fbbb49f8c427"> 1086</a></span>std::string <a class="code hl_function" href="class_prompt_builder.html#a68ca15c2b188625ac36693e471ceb20c">PromptBuilder::BuildWeaponComponentJsonPrompt</a>(<span class="keyword">const</span> <a class="code hl_struct" href="struct_food_generate_params.html">FoodGenerateParams</a>&amp; params,</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>                                                          <span class="keyword">const</span> <a class="code hl_struct" href="struct_custom_preset.html">CustomPreset</a>&amp; customPreset,</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>                                                          <span class="keyword">const</span> std::set&lt;std::string&gt;&amp; excludeIds,</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>                                                          <span class="keyword">const</span> std::string&amp; modelName,</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>                                                          <span class="keyword">const</span> std::string&amp; generationTimestamp,</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>                                                          <span class="keywordtype">int</span> existingCount)</div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>{</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>    std::string presetContext = <a class="code hl_function" href="class_prompt_builder.html#add1bfe5a2fd49bd2b2ddef2d29a1b5de">GetPresetFlavorText</a>(customPreset);</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>    std::string presetName = customPreset.<a class="code hl_variable" href="struct_custom_preset.html#a7169ba2db551ca89884436475926e982">displayName</a>.empty() ? customPreset.<a class="code hl_variable" href="struct_custom_preset.html#aac31fc92ad757067de5661c3270ec54c">id</a> : customPreset.<a class="code hl_variable" href="struct_custom_preset.html#a7169ba2db551ca89884436475926e982">displayName</a>;</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>    std::string presetSlug = ToSlug(presetName);</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span> </div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>    std::vector&lt;std::string&gt; templateCandidates =</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>    {</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>        <span class="stringliteral">&quot;weapon_component_custom_&quot;</span> + presetSlug,</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>        <span class="stringliteral">&quot;weapon_component_&quot;</span> + presetSlug,</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>        <span class="stringliteral">&quot;weapon_component&quot;</span></div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>    };</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span> </div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>    std::string templatePrompt = TryLoadTemplateWithFallback(</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>        templateCandidates,</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>        presetContext,</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>        params,</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>        excludeIds,</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>        presetName,</div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>        <span class="stringliteral">&quot;WeaponComponent&quot;</span>,</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>        modelName,</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>        generationTimestamp,</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>        existingCount);</div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>    <span class="keywordflow">if</span> (!templatePrompt.empty())</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>    {</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>        <span class="keywordflow">return</span> templatePrompt;</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>    }</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span> </div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>    std::string prompt;</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>    prompt += presetContext;</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>    prompt += <span class="stringliteral">&quot;Task:\n&quot;</span>;</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>    prompt += <span class="stringliteral">&quot;Generate &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#a7254056f520c27e1852d50ef8df32203">count</a>) + <span class="stringliteral">&quot; weapon attachment components &quot;</span>;</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>    prompt += <span class="stringliteral">&quot;for this survival setting.\n&quot;</span>;</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>    prompt += BuildExcludeSection(excludeIds);</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>    prompt += <span class="stringliteral">&quot;Use this JSON schema EXACTLY for each component:\n&quot;</span>;</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>    prompt += <span class="stringliteral">&quot;{\n&quot;</span>;</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>    prompt += <span class="stringliteral">&quot;  \&quot;id\&quot;: string (unique, lowercase, underscore),\n&quot;</span>;</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>    prompt += <span class="stringliteral">&quot;  \&quot;displayName\&quot;: string,\n&quot;</span>;</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>    prompt += <span class="stringliteral">&quot;  \&quot;category\&quot;: \&quot;WeaponComponent\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>    prompt += <span class="stringliteral">&quot;  \&quot;rarity\&quot;: \&quot;Common\&quot; | \&quot;Uncommon\&quot; | \&quot;Rare\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>    prompt += <span class="stringliteral">&quot;  \&quot;maxStack\&quot;: integer (usually 1 for components),\n&quot;</span>;</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>    prompt += <span class="stringliteral">&quot;  \&quot;componentType\&quot;: \&quot;Muzzle\&quot; | \&quot;Grip\&quot; | \&quot;Sight\&quot; | \&quot;Scope\&quot; | \&quot;Stock\&quot; | \&quot;Barrel\&quot; | \&quot;Handguard\&quot; | \&quot;Rail\&quot; | \&quot;Flashlight\&quot; | \&quot;Laser\&quot; | \&quot;Magazine\&quot; | \&quot;GasBlock\&quot; | \&quot;ChargingHandle\&quot; | \&quot;PistolGrip\&quot; | \&quot;Foregrip\&quot; | \&quot;Bipod\&quot; | \&quot;TacticalDevice\&quot; | \&quot;Mount\&quot; | \&quot;Adapter\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>    prompt += <span class="stringliteral">&quot;  // For Magazine components ONLY:\n&quot;</span>;</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>    prompt += <span class="stringliteral">&quot;  \&quot;magazineCapacity\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>    prompt += <span class="stringliteral">&quot;  \&quot;caliber\&quot;: string,\n&quot;</span>;</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>    prompt += <span class="stringliteral">&quot;  \&quot;magazineType\&quot;: string,\n&quot;</span>;</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>    prompt += <span class="stringliteral">&quot;  \&quot;loadedRounds\&quot;: [\n&quot;</span>;</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>    prompt += <span class="stringliteral">&quot;    { \&quot;orderIndex\&quot;: integer, \&quot;roundCount\&quot;: integer, \&quot;ammoId\&quot;: string, \&quot;ammoDisplayName\&quot;: string, \&quot;ammoNotes\&quot;: string }\n&quot;</span>;</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>    prompt += <span class="stringliteral">&quot;  ],\n&quot;</span>;</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>    prompt += <span class="stringliteral">&quot;  \&quot;compatibleSlots\&quot;: [string],\n&quot;</span>;</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>    prompt += <span class="stringliteral">&quot;  \&quot;subSlots\&quot;: [\n&quot;</span>;</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>    prompt += <span class="stringliteral">&quot;    { \&quot;slotType\&quot;: string, \&quot;slotIndex\&quot;: integer, \&quot;hasBuiltInRail\&quot;: boolean }\n&quot;</span>;</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>    prompt += <span class="stringliteral">&quot;  ],\n&quot;</span>;</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>    prompt += <span class="stringliteral">&quot;  \&quot;damageModifier\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>    prompt += <span class="stringliteral">&quot;  \&quot;recoilModifier\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>    prompt += <span class="stringliteral">&quot;  \&quot;ergonomicsModifier\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>    prompt += <span class="stringliteral">&quot;  \&quot;accuracyModifier\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>    prompt += <span class="stringliteral">&quot;  \&quot;weightModifier\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>    prompt += <span class="stringliteral">&quot;  \&quot;muzzleVelocityModifier\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>    prompt += <span class="stringliteral">&quot;  \&quot;effectiveRangeModifier\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>    prompt += <span class="stringliteral">&quot;  \&quot;penetrationModifier\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>    prompt += <span class="stringliteral">&quot;  \&quot;hasBuiltInRail\&quot;: boolean,\n&quot;</span>;</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>    prompt += <span class="stringliteral">&quot;  \&quot;railType\&quot;: string,\n&quot;</span>;</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>    prompt += <span class="stringliteral">&quot;  \&quot;description\&quot;: string\n&quot;</span>;</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>    prompt += <span class="stringliteral">&quot;}\n&quot;</span>;</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>    prompt += <span class="stringliteral">&quot;Balancing:\n&quot;</span>;</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>    prompt += <span class="stringliteral">&quot;- Common components: small stat bonuses (0-5), basic design.\n&quot;</span>;</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>    prompt += <span class="stringliteral">&quot;- Uncommon components: medium stat bonuses (5-15), better design.\n&quot;</span>;</div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>    prompt += <span class="stringliteral">&quot;- Rare components: large stat bonuses (10-25), advanced design.\n&quot;</span>;</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>    prompt += <span class="stringliteral">&quot;Output:\n&quot;</span>;</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>    prompt += <span class="stringliteral">&quot;- Output ONLY a JSON array of components.\n&quot;</span>;</div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>    prompt += <span class="stringliteral">&quot;- No comments, no extra text, no Markdown, no explanation.\n&quot;</span>;</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>    <span class="keywordflow">return</span> prompt;</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>}</div>
</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span> </div>
<div class="foldopen" id="foldopen01175" data-start="{" data-end="}">
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"><a class="line" href="class_prompt_builder.html#a13830108797c9c98ad9f6af928bd56bc"> 1175</a></span>std::string <a class="code hl_function" href="class_prompt_builder.html#a13830108797c9c98ad9f6af928bd56bc">PromptBuilder::BuildAmmoJsonPrompt</a>(<span class="keyword">const</span> <a class="code hl_struct" href="struct_food_generate_params.html">FoodGenerateParams</a>&amp; params,</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>                                               <a class="code hl_enumeration" href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52c">PresetType</a> preset,</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>                                               <span class="keyword">const</span> std::set&lt;std::string&gt;&amp; excludeIds,</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>                                               <span class="keyword">const</span> std::string&amp; modelName,</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>                                               <span class="keyword">const</span> std::string&amp; generationTimestamp,</div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>                                               <span class="keywordtype">int</span> existingCount)</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>{</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>    std::string presetContext = <a class="code hl_function" href="class_prompt_builder.html#add1bfe5a2fd49bd2b2ddef2d29a1b5de">GetPresetFlavorText</a>(preset);</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>    std::string presetName = GetPresetNameString(preset);</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>    std::string presetSlug = ToSlug(presetName);</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span> </div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>    std::vector&lt;std::string&gt; templateCandidates =</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>    {</div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>        <span class="stringliteral">&quot;ammo_&quot;</span> + presetSlug,</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>        <span class="stringliteral">&quot;ammo&quot;</span></div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>    };</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span> </div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>    std::string templatePrompt = TryLoadTemplateWithFallback(</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>        templateCandidates,</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>        presetContext,</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>        params,</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>        excludeIds,</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>        presetName,</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>        <span class="stringliteral">&quot;Ammo&quot;</span>,</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>        modelName,</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>        generationTimestamp,</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>        existingCount);</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>    <span class="keywordflow">if</span> (!templatePrompt.empty())</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>    {</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>        <span class="keywordflow">return</span> templatePrompt;</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>    }</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span> </div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>    std::string prompt;</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span> </div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>    <span class="comment">// 1) Add preset world context</span></div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>    prompt += presetContext;</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span> </div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>    <span class="comment">// 2) Task description</span></div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>    prompt += <span class="stringliteral">&quot;Task:\n&quot;</span>;</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>    prompt += <span class="stringliteral">&quot;Generate &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#a7254056f520c27e1852d50ef8df32203">count</a>) + <span class="stringliteral">&quot; ammunition items &quot;</span>;</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>    prompt += <span class="stringliteral">&quot;for this survival setting.\n\n&quot;</span>;</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span> </div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>    <span class="comment">// 3) Add exclusion list if provided</span></div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>    prompt += BuildExcludeSection(excludeIds);</div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span> </div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>    <span class="comment">// 4) Define JSON schema</span></div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>    prompt += <span class="stringliteral">&quot;Use this JSON schema EXACTLY for each ammo:\n&quot;</span>;</div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>    prompt += <span class="stringliteral">&quot;{\n&quot;</span>;</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>    prompt += <span class="stringliteral">&quot;  \&quot;id\&quot;: string (unique, lowercase, underscore),\n&quot;</span>;</div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>    prompt += <span class="stringliteral">&quot;  \&quot;displayName\&quot;: string,\n&quot;</span>;</div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>    prompt += <span class="stringliteral">&quot;  \&quot;category\&quot;: \&quot;Ammo\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span>    prompt += <span class="stringliteral">&quot;  \&quot;rarity\&quot;: \&quot;Common\&quot; | \&quot;Uncommon\&quot; | \&quot;Rare\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>    prompt += <span class="stringliteral">&quot;  \&quot;maxStack\&quot;: integer (usually 20-100 for ammo),\n&quot;</span>;</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>    prompt += <span class="stringliteral">&quot;  \&quot;caliber\&quot;: string (e.g., \&quot;9mm\&quot;, \&quot;5.56mm\&quot;, \&quot;7.62mm\&quot;, \&quot;12gauge\&quot;, \&quot;.45ACP\&quot;),\n&quot;</span>;</div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>    prompt += <span class="stringliteral">&quot;  \&quot;damageBonus\&quot;: integer,      // Damage bonus/penalty (can be negative, range -50 to 50)\n&quot;</span>;</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>    prompt += <span class="stringliteral">&quot;  \&quot;penetration\&quot;: integer,      // 0-100, armor penetration (higher is better)\n&quot;</span>;</div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span>    prompt += <span class="stringliteral">&quot;  \&quot;accuracyBonus\&quot;: integer,    // Accuracy bonus/penalty (can be negative, range -50 to 50)\n&quot;</span>;</div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span>    prompt += <span class="stringliteral">&quot;  \&quot;recoilModifier\&quot;: integer,   // Recoil modifier (positive = less recoil, can be negative, range -50 to 50)\n&quot;</span>;</div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>    prompt += <span class="stringliteral">&quot;  \&quot;armorPiercing\&quot;: boolean,    // If true, has high penetration\n&quot;</span>;</div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span>    prompt += <span class="stringliteral">&quot;  \&quot;hollowPoint\&quot;: boolean,      // If true, higher damage but lower penetration\n&quot;</span>;</div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>    prompt += <span class="stringliteral">&quot;  \&quot;tracer\&quot;: boolean,           // If true, visible trajectory\n&quot;</span>;</div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span>    prompt += <span class="stringliteral">&quot;  \&quot;incendiary\&quot;: boolean,       // If true, can cause fire damage\n&quot;</span>;</div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>    prompt += <span class="stringliteral">&quot;  \&quot;value\&quot;: integer,            // 0-100, trade/scrap value\n&quot;</span>;</div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>    prompt += <span class="stringliteral">&quot;  \&quot;description\&quot;: string\n&quot;</span>;</div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>    prompt += <span class="stringliteral">&quot;}\n&quot;</span>;</div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>    prompt += <span class="stringliteral">&quot;IMPORTANT:\n&quot;</span>;</div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>    prompt += <span class="stringliteral">&quot;- category MUST be \&quot;Ammo\&quot;.\n&quot;</span>;</div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>    prompt += <span class="stringliteral">&quot;- description must NOT be empty and should be 1 short sentence (5-20 words)\n&quot;</span>;</div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>    prompt += <span class="stringliteral">&quot;  that describes the ammo&#39;s characteristics and use.\n&quot;</span>;</div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>    prompt += <span class="stringliteral">&quot;- caliber must match weapon calibers (e.g., \&quot;9mm\&quot;, \&quot;5.56mm\&quot;, \&quot;7.62mm\&quot;, \&quot;12gauge\&quot;).\n&quot;</span>;</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>    prompt += <span class="stringliteral">&quot;- Special properties:\n&quot;</span>;</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>    prompt += <span class="stringliteral">&quot;  * Armor Piercing: high penetration (50-100), usually lower damage bonus.\n&quot;</span>;</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>    prompt += <span class="stringliteral">&quot;  * Hollow Point: high damage bonus (5-20), but low penetration (0-30).\n&quot;</span>;</div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>    prompt += <span class="stringliteral">&quot;  * Tracer: visible trajectory, usually no stat modifiers.\n&quot;</span>;</div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>    prompt += <span class="stringliteral">&quot;  * Incendiary: can cause fire damage, usually higher value.\n&quot;</span>;</div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>    prompt += <span class="stringliteral">&quot;Balancing:\n&quot;</span>;</div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>    prompt += <span class="stringliteral">&quot;- Common ammo: standard stats, no special properties, low value (5-20).\n&quot;</span>;</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>    prompt += <span class="stringliteral">&quot;- Uncommon ammo: better stats or one special property, medium value (15-40).\n&quot;</span>;</div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>    prompt += <span class="stringliteral">&quot;- Rare ammo: excellent stats or multiple special properties, high value (30-80).\n&quot;</span>;</div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>    prompt += <span class="stringliteral">&quot;- Standard ammo: damageBonus 0-5, penetration 20-40, no special properties.\n&quot;</span>;</div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>    prompt += <span class="stringliteral">&quot;- Armor Piercing: penetration 50-100, damageBonus -10 to 5.\n&quot;</span>;</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>    prompt += <span class="stringliteral">&quot;- Hollow Point: damageBonus 5-20, penetration 0-30.\n&quot;</span>;</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>    prompt += <span class="stringliteral">&quot;- All stat values must be within their specified ranges.\n&quot;</span>;</div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>    prompt += <span class="stringliteral">&quot;Output:\n&quot;</span>;</div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>    prompt += <span class="stringliteral">&quot;- Output ONLY a JSON array of ammo items.\n&quot;</span>;</div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>    prompt += <span class="stringliteral">&quot;- No comments, no extra text, no Markdown, no explanation.\n&quot;</span>;</div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span> </div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>    <span class="keywordflow">return</span> prompt;</div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>}</div>
</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span> </div>
<div class="foldopen" id="foldopen01273" data-start="{" data-end="}">
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"><a class="line" href="class_prompt_builder.html#aa6a610449869cad03e8df42ce530b7c5"> 1273</a></span>std::string <a class="code hl_function" href="class_prompt_builder.html#a13830108797c9c98ad9f6af928bd56bc">PromptBuilder::BuildAmmoJsonPrompt</a>(<span class="keyword">const</span> <a class="code hl_struct" href="struct_food_generate_params.html">FoodGenerateParams</a>&amp; params,</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span>                                               <span class="keyword">const</span> <a class="code hl_struct" href="struct_custom_preset.html">CustomPreset</a>&amp; customPreset,</div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>                                               <span class="keyword">const</span> std::set&lt;std::string&gt;&amp; excludeIds,</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>                                               <span class="keyword">const</span> std::string&amp; modelName,</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>                                               <span class="keyword">const</span> std::string&amp; generationTimestamp,</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>                                               <span class="keywordtype">int</span> existingCount)</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>{</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>    std::string presetContext = <a class="code hl_function" href="class_prompt_builder.html#add1bfe5a2fd49bd2b2ddef2d29a1b5de">GetPresetFlavorText</a>(customPreset);</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>    std::string presetName = customPreset.<a class="code hl_variable" href="struct_custom_preset.html#a7169ba2db551ca89884436475926e982">displayName</a>.empty() ? customPreset.<a class="code hl_variable" href="struct_custom_preset.html#aac31fc92ad757067de5661c3270ec54c">id</a> : customPreset.<a class="code hl_variable" href="struct_custom_preset.html#a7169ba2db551ca89884436475926e982">displayName</a>;</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>    std::string presetSlug = ToSlug(presetName);</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span> </div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>    std::vector&lt;std::string&gt; templateCandidates =</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>    {</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>        <span class="stringliteral">&quot;ammo_custom_&quot;</span> + presetSlug,</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>        <span class="stringliteral">&quot;ammo_&quot;</span> + presetSlug,</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>        <span class="stringliteral">&quot;ammo&quot;</span></div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>    };</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span> </div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>    std::string templatePrompt = TryLoadTemplateWithFallback(</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>        templateCandidates,</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>        presetContext,</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>        params,</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>        excludeIds,</div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>        presetName,</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>        <span class="stringliteral">&quot;Ammo&quot;</span>,</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>        modelName,</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>        generationTimestamp,</div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>        existingCount);</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>    <span class="keywordflow">if</span> (!templatePrompt.empty())</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>    {</div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>        <span class="keywordflow">return</span> templatePrompt;</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>    }</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span> </div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>    std::string prompt;</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>    prompt += presetContext;</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>    prompt += <span class="stringliteral">&quot;Task:\n&quot;</span>;</div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>    prompt += <span class="stringliteral">&quot;Generate &quot;</span> + std::to_string(params.<a class="code hl_variable" href="struct_food_generate_params.html#a7254056f520c27e1852d50ef8df32203">count</a>) + <span class="stringliteral">&quot; ammunition items &quot;</span>;</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span>    prompt += <span class="stringliteral">&quot;for this survival setting.\n&quot;</span>;</div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>    prompt += BuildExcludeSection(excludeIds);</div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>    prompt += <span class="stringliteral">&quot;Use this JSON schema EXACTLY for each ammo item:\n&quot;</span>;</div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>    prompt += <span class="stringliteral">&quot;{\n&quot;</span>;</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>    prompt += <span class="stringliteral">&quot;  \&quot;id\&quot;: string (unique, lowercase, underscore),\n&quot;</span>;</div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>    prompt += <span class="stringliteral">&quot;  \&quot;displayName\&quot;: string,\n&quot;</span>;</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>    prompt += <span class="stringliteral">&quot;  \&quot;category\&quot;: \&quot;Ammo\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span>    prompt += <span class="stringliteral">&quot;  \&quot;rarity\&quot;: \&quot;Common\&quot; | \&quot;Uncommon\&quot; | \&quot;Rare\&quot;,\n&quot;</span>;</div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>    prompt += <span class="stringliteral">&quot;  \&quot;maxStack\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>    prompt += <span class="stringliteral">&quot;  \&quot;caliber\&quot;: string,\n&quot;</span>;</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span>    prompt += <span class="stringliteral">&quot;  \&quot;damageBonus\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>    prompt += <span class="stringliteral">&quot;  \&quot;penetration\&quot;: integer (0-100),\n&quot;</span>;</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>    prompt += <span class="stringliteral">&quot;  \&quot;accuracyBonus\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>    prompt += <span class="stringliteral">&quot;  \&quot;recoilModifier\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span>    prompt += <span class="stringliteral">&quot;  \&quot;armorPiercing\&quot;: boolean,\n&quot;</span>;</div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span>    prompt += <span class="stringliteral">&quot;  \&quot;hollowPoint\&quot;: boolean,\n&quot;</span>;</div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>    prompt += <span class="stringliteral">&quot;  \&quot;tracer\&quot;: boolean,\n&quot;</span>;</div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>    prompt += <span class="stringliteral">&quot;  \&quot;incendiary\&quot;: boolean,\n&quot;</span>;</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>    prompt += <span class="stringliteral">&quot;  \&quot;value\&quot;: integer,\n&quot;</span>;</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span>    prompt += <span class="stringliteral">&quot;  \&quot;description\&quot;: string\n&quot;</span>;</div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>    prompt += <span class="stringliteral">&quot;}\n&quot;</span>;</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>    prompt += <span class="stringliteral">&quot;Balancing rules:\n&quot;</span>;</div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>    prompt += <span class="stringliteral">&quot;- Common: damageBonus 0-5, penetration 10-30, basic ammo.\n&quot;</span>;</div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span>    prompt += <span class="stringliteral">&quot;- Uncommon: damageBonus 3-10, penetration 25-50, special properties.\n&quot;</span>;</div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>    prompt += <span class="stringliteral">&quot;- Rare: damageBonus 8-15, penetration 40-70, advanced properties.\n&quot;</span>;</div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span>    prompt += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span>    prompt += <span class="stringliteral">&quot;Output:\n&quot;</span>;</div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span>    prompt += <span class="stringliteral">&quot;- Output ONLY a JSON array of ammo items.\n&quot;</span>;</div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span>    prompt += <span class="stringliteral">&quot;- No comments, no extra text, no Markdown, no explanation.\n&quot;</span>;</div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span>    <span class="keywordflow">return</span> prompt;</div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span>}</div>
</div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span> </div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span> </div>
<div class="ttc" id="a_custom_preset_8h_html"><div class="ttname"><a href="_custom_preset_8h.html">CustomPreset.h</a></div><div class="ttdoc">Custom preset data structure and management.</div></div>
<div class="ttc" id="a_prompt_builder_8h_html"><div class="ttname"><a href="_prompt_builder_8h.html">PromptBuilder.h</a></div><div class="ttdoc">Builds prompts for LLM item generation.</div></div>
<div class="ttc" id="a_prompt_builder_8h_html_a2f25755adcf9a7606dba09cd6e7eb52c"><div class="ttname"><a href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52c">PresetType</a></div><div class="ttdeci">PresetType</div><div class="ttdoc">Built-in preset types for item generation.</div><div class="ttdef"><b>Definition</b> <a href="_prompt_builder_8h_source.html#l00027">PromptBuilder.h:28</a></div></div>
<div class="ttc" id="a_prompt_builder_8h_html_a2f25755adcf9a7606dba09cd6e7eb52ca000c016d34ff41e245b69c67f22c83ff"><div class="ttname"><a href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52ca000c016d34ff41e245b69c67f22c83ff">PresetType::Desert</a></div><div class="ttdeci">@ Desert</div><div class="ttdoc">Desert/arid survival setting.</div><div class="ttdef"><b>Definition</b> <a href="_prompt_builder_8h_source.html#l00031">PromptBuilder.h:31</a></div></div>
<div class="ttc" id="a_prompt_builder_8h_html_a2f25755adcf9a7606dba09cd6e7eb52ca44f027304a424f444963d27ad46da394"><div class="ttname"><a href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52ca44f027304a424f444963d27ad46da394">PresetType::Coast</a></div><div class="ttdeci">@ Coast</div><div class="ttdoc">Coastal/beach survival setting.</div><div class="ttdef"><b>Definition</b> <a href="_prompt_builder_8h_source.html#l00032">PromptBuilder.h:32</a></div></div>
<div class="ttc" id="a_prompt_builder_8h_html_a2f25755adcf9a7606dba09cd6e7eb52ca57d056ed0984166336b7879c2af3657f"><div class="ttname"><a href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52ca57d056ed0984166336b7879c2af3657f">PresetType::City</a></div><div class="ttdeci">@ City</div><div class="ttdoc">Urban/city survival setting.</div><div class="ttdef"><b>Definition</b> <a href="_prompt_builder_8h_source.html#l00033">PromptBuilder.h:33</a></div></div>
<div class="ttc" id="a_prompt_builder_8h_html_a2f25755adcf9a7606dba09cd6e7eb52ca7a1920d61156abc05a60135aefe8bc67"><div class="ttname"><a href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52ca7a1920d61156abc05a60135aefe8bc67">PresetType::Default</a></div><div class="ttdeci">@ Default</div><div class="ttdoc">Default/generic survival game setting.</div><div class="ttdef"><b>Definition</b> <a href="_prompt_builder_8h_source.html#l00029">PromptBuilder.h:29</a></div></div>
<div class="ttc" id="a_prompt_builder_8h_html_a2f25755adcf9a7606dba09cd6e7eb52caac12ee4aedb176eb73ce3f6c0d1e9036"><div class="ttname"><a href="_prompt_builder_8h.html#a2f25755adcf9a7606dba09cd6e7eb52caac12ee4aedb176eb73ce3f6c0d1e9036">PresetType::Forest</a></div><div class="ttdeci">@ Forest</div><div class="ttdoc">Forest/wilderness survival setting.</div><div class="ttdef"><b>Definition</b> <a href="_prompt_builder_8h_source.html#l00030">PromptBuilder.h:30</a></div></div>
<div class="ttc" id="a_prompt_template_loader_8h_html"><div class="ttname"><a href="_prompt_template_loader_8h.html">PromptTemplateLoader.h</a></div><div class="ttdoc">Loads and processes prompt templates from external files.</div></div>
<div class="ttc" id="aclass_prompt_builder_html_a13830108797c9c98ad9f6af928bd56bc"><div class="ttname"><a href="class_prompt_builder.html#a13830108797c9c98ad9f6af928bd56bc">PromptBuilder::BuildAmmoJsonPrompt</a></div><div class="ttdeci">static std::string BuildAmmoJsonPrompt(const FoodGenerateParams &amp;params, PresetType preset, const std::set&lt; std::string &gt; &amp;excludeIds=std::set&lt; std::string &gt;(), const std::string &amp;modelName=std::string(), const std::string &amp;generationTimestamp=std::string(), int existingCount=-1)</div><div class="ttdoc">Build ammo item generation prompt (built-in preset).</div><div class="ttdef"><b>Definition</b> <a href="#l01175">PromptBuilder.cpp:1175</a></div></div>
<div class="ttc" id="aclass_prompt_builder_html_a4dbbfeb85017a5b3692757587170ee1c"><div class="ttname"><a href="class_prompt_builder.html#a4dbbfeb85017a5b3692757587170ee1c">PromptBuilder::BuildFoodJsonPrompt</a></div><div class="ttdeci">static std::string BuildFoodJsonPrompt(const FoodGenerateParams &amp;params, PresetType preset, const std::set&lt; std::string &gt; &amp;excludeIds=std::set&lt; std::string &gt;(), const std::string &amp;modelName=std::string(), const std::string &amp;generationTimestamp=std::string(), int existingCount=-1)</div><div class="ttdoc">Build food item generation prompt (built-in preset).</div><div class="ttdef"><b>Definition</b> <a href="#l00177">PromptBuilder.cpp:177</a></div></div>
<div class="ttc" id="aclass_prompt_builder_html_a68ca15c2b188625ac36693e471ceb20c"><div class="ttname"><a href="class_prompt_builder.html#a68ca15c2b188625ac36693e471ceb20c">PromptBuilder::BuildWeaponComponentJsonPrompt</a></div><div class="ttdeci">static std::string BuildWeaponComponentJsonPrompt(const FoodGenerateParams &amp;params, PresetType preset, const std::set&lt; std::string &gt; &amp;excludeIds=std::set&lt; std::string &gt;(), const std::string &amp;modelName=std::string(), const std::string &amp;generationTimestamp=std::string(), int existingCount=-1)</div><div class="ttdoc">Build weapon component item generation prompt (built-in preset).</div><div class="ttdef"><b>Definition</b> <a href="#l00927">PromptBuilder.cpp:927</a></div></div>
<div class="ttc" id="aclass_prompt_builder_html_acb3d86d01fad3840d052cc9d262098a5"><div class="ttname"><a href="class_prompt_builder.html#acb3d86d01fad3840d052cc9d262098a5">PromptBuilder::BuildWeaponJsonPrompt</a></div><div class="ttdeci">static std::string BuildWeaponJsonPrompt(const FoodGenerateParams &amp;params, PresetType preset, const std::set&lt; std::string &gt; &amp;excludeIds=std::set&lt; std::string &gt;(), const std::string &amp;modelName=std::string(), const std::string &amp;generationTimestamp=std::string(), int existingCount=-1)</div><div class="ttdoc">Build weapon item generation prompt (built-in preset).</div><div class="ttdef"><b>Definition</b> <a href="#l00686">PromptBuilder.cpp:686</a></div></div>
<div class="ttc" id="aclass_prompt_builder_html_ad764c13df10dd52e205dbb7cc4901c8b"><div class="ttname"><a href="class_prompt_builder.html#ad764c13df10dd52e205dbb7cc4901c8b">PromptBuilder::BuildMaterialJsonPrompt</a></div><div class="ttdeci">static std::string BuildMaterialJsonPrompt(const FoodGenerateParams &amp;params, PresetType preset, const std::set&lt; std::string &gt; &amp;excludeIds=std::set&lt; std::string &gt;(), const std::string &amp;modelName=std::string(), const std::string &amp;generationTimestamp=std::string(), int existingCount=-1)</div><div class="ttdoc">Build material item generation prompt (built-in preset).</div><div class="ttdef"><b>Definition</b> <a href="#l00528">PromptBuilder.cpp:528</a></div></div>
<div class="ttc" id="aclass_prompt_builder_html_add1bfe5a2fd49bd2b2ddef2d29a1b5de"><div class="ttname"><a href="class_prompt_builder.html#add1bfe5a2fd49bd2b2ddef2d29a1b5de">PromptBuilder::GetPresetFlavorText</a></div><div class="ttdeci">static std::string GetPresetFlavorText(PresetType preset)</div><div class="ttdoc">Get preset flavor text for built-in preset.</div><div class="ttdef"><b>Definition</b> <a href="#l00128">PromptBuilder.cpp:128</a></div></div>
<div class="ttc" id="aclass_prompt_builder_html_af573636eb2d4440020edd5d56bcbceb7"><div class="ttname"><a href="class_prompt_builder.html#af573636eb2d4440020edd5d56bcbceb7">PromptBuilder::BuildDrinkJsonPrompt</a></div><div class="ttdeci">static std::string BuildDrinkJsonPrompt(const FoodGenerateParams &amp;params, PresetType preset, const std::set&lt; std::string &gt; &amp;excludeIds=std::set&lt; std::string &gt;(), const std::string &amp;modelName=std::string(), const std::string &amp;generationTimestamp=std::string(), int existingCount=-1)</div><div class="ttdoc">Build drink item generation prompt (built-in preset).</div><div class="ttdef"><b>Definition</b> <a href="#l00360">PromptBuilder.cpp:360</a></div></div>
<div class="ttc" id="aclass_prompt_template_loader_html_add8e4ac7fd227f55959fe0e4fefc0652"><div class="ttname"><a href="class_prompt_template_loader.html#add8e4ac7fd227f55959fe0e4fefc0652">PromptTemplateLoader::LoadTemplate</a></div><div class="ttdeci">static std::string LoadTemplate(const std::string &amp;templateName, const std::string &amp;presetContext, int maxHunger, int maxThirst, int count, const std::set&lt; std::string &gt; &amp;excludeIds=std::set&lt; std::string &gt;(), const std::string &amp;presetName=&quot;&quot;, const std::string &amp;itemTypeName=&quot;&quot;, const std::string &amp;modelName=&quot;&quot;, const std::string &amp;generationTimestamp=&quot;&quot;, int existingCount=-1)</div><div class="ttdoc">Load template from file and replace variables.</div><div class="ttdef"><b>Definition</b> <a href="_prompt_template_loader_8cpp_source.html#l00045">PromptTemplateLoader.cpp:45</a></div></div>
<div class="ttc" id="anamespace_custom_preset_manager_html_ac7bd53ae26d97a50620737c3abb4f3a4"><div class="ttname"><a href="namespace_custom_preset_manager.html#ac7bd53ae26d97a50620737c3abb4f3a4">CustomPresetManager::GetPresetFlavorText</a></div><div class="ttdeci">std::string GetPresetFlavorText(const CustomPreset &amp;preset)</div><div class="ttdoc">Get preset flavor text.</div><div class="ttdef"><b>Definition</b> <a href="_custom_preset_8cpp_source.html#l00128">CustomPreset.cpp:128</a></div></div>
<div class="ttc" id="astruct_custom_preset_html"><div class="ttname"><a href="struct_custom_preset.html">CustomPreset</a></div><div class="ttdoc">Data structure for custom world presets.</div><div class="ttdef"><b>Definition</b> <a href="_custom_preset_8h_source.html#l00025">CustomPreset.h:26</a></div></div>
<div class="ttc" id="astruct_custom_preset_html_a7169ba2db551ca89884436475926e982"><div class="ttname"><a href="struct_custom_preset.html#a7169ba2db551ca89884436475926e982">CustomPreset::displayName</a></div><div class="ttdeci">std::string displayName</div><div class="ttdoc">Human-readable display name.</div><div class="ttdef"><b>Definition</b> <a href="_custom_preset_8h_source.html#l00039">CustomPreset.h:39</a></div></div>
<div class="ttc" id="astruct_custom_preset_html_aac31fc92ad757067de5661c3270ec54c"><div class="ttname"><a href="struct_custom_preset.html#aac31fc92ad757067de5661c3270ec54c">CustomPreset::id</a></div><div class="ttdeci">std::string id</div><div class="ttdoc">Unique identifier (lowercase, underscore-separated).</div><div class="ttdef"><b>Definition</b> <a href="_custom_preset_8h_source.html#l00032">CustomPreset.h:32</a></div></div>
<div class="ttc" id="astruct_food_generate_params_html"><div class="ttname"><a href="struct_food_generate_params.html">FoodGenerateParams</a></div><div class="ttdef"><b>Definition</b> <a href="_item_generate_params_8h_source.html#l00016">ItemGenerateParams.h:17</a></div></div>
<div class="ttc" id="astruct_food_generate_params_html_a0c2d76f873e095ddde37c8d4932af2c7"><div class="ttname"><a href="struct_food_generate_params.html#a0c2d76f873e095ddde37c8d4932af2c7">FoodGenerateParams::maxThirst</a></div><div class="ttdeci">int maxThirst</div><div class="ttdef"><b>Definition</b> <a href="_item_generate_params_8h_source.html#l00020">ItemGenerateParams.h:20</a></div></div>
<div class="ttc" id="astruct_food_generate_params_html_a7254056f520c27e1852d50ef8df32203"><div class="ttname"><a href="struct_food_generate_params.html#a7254056f520c27e1852d50ef8df32203">FoodGenerateParams::count</a></div><div class="ttdeci">int count</div><div class="ttdef"><b>Definition</b> <a href="_item_generate_params_8h_source.html#l00018">ItemGenerateParams.h:18</a></div></div>
<div class="ttc" id="astruct_food_generate_params_html_aab329af04e5297b3b3867bc01ac00f64"><div class="ttname"><a href="struct_food_generate_params.html#aab329af04e5297b3b3867bc01ac00f64">FoodGenerateParams::maxHunger</a></div><div class="ttdeci">int maxHunger</div><div class="ttdef"><b>Definition</b> <a href="_item_generate_params_8h_source.html#l00019">ItemGenerateParams.h:19</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_8fb9b310bc4b057714d6d720c9012bf0.html">RundeeItemFactory</a></li><li class="navelem"><a href="dir_be8e5b9f143663ceeb535c56612eb031.html">RundeeItemFactory</a></li><li class="navelem"><a href="dir_5b468c435da5a65f1129a96dec8f0aa5.html">src</a></li><li class="navelem"><a href="dir_420f34316f689232f2ac22155a6fb191.html">Prompts</a></li><li class="navelem"><a href="_prompt_builder_8cpp.html">PromptBuilder.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
